var Pe=Object.defineProperty;var xe=(a,p,_)=>p in a?Pe(a,p,{enumerable:!0,configurable:!0,writable:!0,value:_}):a[p]=_;var T=(a,p,_)=>(xe(a,typeof p!="symbol"?p+"":p,_),_),Q=(a,p,_)=>{if(!p.has(a))throw TypeError("Cannot "+_)};var i=(a,p,_)=>(Q(a,p,"read from private field"),_?_.call(a):p.get(a)),A=(a,p,_)=>{if(p.has(a))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(a):p.set(a,_)},x=(a,p,_,V)=>(Q(a,p,"write to private field"),V?V.call(a,_):p.set(a,_),_);var I=(a,p,_)=>(Q(a,p,"access private method"),_);(function(a,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(a=typeof globalThis<"u"?globalThis:a||self,p(a.PlumeJS={}))})(this,function(a){var H,ae,D,W,$,C,N,z,he;"use strict";const p=new(ae=class{constructor(){A(this,H,void 0);x(this,H,new WeakMap)}register(r,e){if(!i(this,H).get(r))i(this,H).set(r,e);else throw console.error(r),"service already exists"}getService(r){const e=i(this,H).get(r);if(e)return e;throw console.error(r),"service is not a registered service."}clear(){x(this,H,new WeakMap)}},H=new WeakMap,ae),_=r=>typeof r=="function",V=r=>{const e=r.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(t=>t.trim()):[]},J=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),Z=(r,e,t,s=!1)=>(r.addEventListener(e,t,s),()=>{r.removeEventListener(e,t,s)}),de=r=>{const e=()=>new DOMParser().parseFromString(r,"text/html").body||document.createElement("body"),t=m=>{const v=m.querySelectorAll("script");for(const R of v)R.remove()},s=(m,v)=>{if(v=v.replace(/\s+/g,"").toLowerCase(),["src","href","xlink:href"].includes(m)&&(v.includes("javascript:")||v.includes("data:"))||m.startsWith("on"))return!0},c=m=>{const v=m.attributes;for(const{name:R,value:K}of v)s(R,K)&&m.removeAttribute(R)},n=m=>{const v=m.children;for(const R of v)c(R),n(R)},d=e();return t(d),n(d),d.innerHTML},fe=function(r){r.renderCount===1&&queueMicrotask(()=>{r.update(),r.renderCount=0})},me=(r,e)=>{const t=V(e),s=()=>({get(c,n){return["[object Object]","[object Array]"].indexOf(Object.prototype.toString.call(c[n]))>-1&&!("__metadata__"in c[n])?new Proxy(c[n],s()):c[n]},set(c,n,d){return c[n]=d,++r.renderCount,fe(r),!0}});return class extends e{constructor(...c){return super(...c),c.forEach((n,d)=>{this[t[d]]=n}),new Proxy(this,s())}}},ee=(r,e,t)=>{if(e.length>0){const s=[];for(const d of e)d.prototype.__metadata__.name!=="RENDERER"?s.push(p.getService(d)):s.push(t);const c=V(r),n=new r(...s);return e.forEach((d,m)=>{n[c[m]]=s[m]}),n}else return new r},M=new class{constructor(){T(this,"globalStyles");T(this,"globalStyleTag");T(this,"style_registry");T(this,"isRootNodeSet");try{this.globalStyles=new CSSStyleSheet}catch{this.globalStyles=""}this.isRootNodeSet=!1,this.globalStyleTag=null}getComputedCss(r=""){let e=[];const t=new CSSStyleSheet;if(t.insertRule(":host { display: block; }"),e=[this.globalStyles,t],r){const s=new CSSStyleSheet;s.replace(r),e.push(s)}return e}},{html:B,render:te}=(()=>{const r=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,t="attr",s=/^attr([^ ]+)/,c="insertNode",n=/^insertNode([^ ]+)/;let d=[];const m=l=>{const o={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let f=JSON.stringify(l);const u=h=>o[h]||h;return f=(h=>h.replace(/[&<>\(\)]/g,u))(f),JSON.parse(f)},v=(l,o)=>{const f=l.options,u=Array.isArray(o)?o:[o];let b,h,y=f.length;for(;y--;){h=f[y];const g=h.getAttribute("value")??(h.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(h.selected=u.indexOf(g)>-1)&&(b=!0)}b||(l.selectedIndex=-1)},R=l=>{const o=document.createElement("template");return o.innerHTML=l,o.content},K=(l,o)=>{const f=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,null);let u=f.nextNode();for(;u;){if(u.hasAttributes()){const b=Array.from(u.attributes).filter(h=>s.test(h.nodeName));for(const{nodeName:h,nodeValue:y}of b){const g=s.exec(h)[1];switch(!0){case/^on+/.test(y):{const P=y.slice(2).toLowerCase();u.removeEventListener(P,o[g]),P!=="bindprops"?u.addEventListener(P,o[g]):u.addEventListener(P,F=>{F.detail.setProps(o[g]())});break}case/ref/.test(y):{const P=(F=>{const q=F;return()=>{q.isConnected&&o[g](q)}})(u);d.push(P);break}case/^data-+/.test(y):case/^aria-+/.test(y):{u.setAttribute(y,m(o[g]));break}case/class/.test(y):{o[g]?u.classList.add(...o[g].split(" ")):u.setAttribute("class","");break}case/value/.test(y):{u.nodeName.toLowerCase()==="select"?v(u,o[g]):u.value=m(o[g]);break}case/disabled/.test(y):case/checked/.test(y):{o[g]?u.setAttribute(y,o[g]):u.removeAttribute(y);break}default:u.setAttribute(y,m(o[g]))}u.removeAttribute(h)}}u=f.nextNode()}},U=(l,o)=>{const f=document.createTreeWalker(l,NodeFilter.SHOW_COMMENT,null);let u=f.nextNode(),b;for(;u;){if(b=n.exec(u.data)){const h=Array.isArray(o[b[1]])?o[b[1]]:[o[b[1]]];u.replaceWith(...h),f.currentNode=l}u=f.nextNode()}},ce=(l,o)=>{if(!l||!o||l.nodeType!==1||o.nodeType!==1)return;const f=l.attributes,u=o.attributes;for(const{name:b,value:h}of f)(!u[b]||u[b]!==h)&&o.setAttribute(b,h);for(const{name:b}of u)f[b]||o.removeAttribute(b)},S=l=>l.nodeType===3?"text":l.nodeType===8?"comment":l.tagName.toLowerCase(),w=l=>l.childNodes&&l.childNodes.length>0?null:l.textContent,E=(l,o)=>{const f=o?Array.from(o.childNodes):[],u=l?Array.from(l.childNodes):[];let b=f.length-u.length;if(b>0)for(;b>0;b--)f[f.length-b].parentNode.removeChild(f[f.length-b]);u.forEach(function(h,y){const g=f[y];if(ce(h,g),!g){o&&o.appendChild(h);return}if(S(h)!==S(g)){g.replaceWith(h);return}const P=w(h);if(P&&P!==w(g)){g.textContent=P;return}if(g.childNodes.length>0&&h.childNodes.length<1){g.innerHTML="";return}if(g.childNodes.length<1&&h.childNodes.length>0){const F=document.createDocumentFragment();E(h,F),g.appendChild(F);return}if(h.childNodes.length>0){E(h,g);return}})};return{html:(l,...o)=>{let f="";const{length:u}=l;for(let h=1;h<u;h++){const y=o[h-1];let g=!1;if(f+=l[h-1],r.test(f)&&e.test(f)&&(f=f.replace(r,(P,F,q)=>`${t}${h-1}=${q||'"'}${F}${q?"":'"'}`),g=!0),!g)switch(!0){case Array.isArray(y):case y instanceof DocumentFragment:{f+=`<!--${c}${h-1}-->`;break}case(typeof y=="object"&&y!==null):{"html"in y&&(f+=y.html);break}default:f+=y}}f+=l[u-1];const b=R(f.trim());return K(b,o),U(b,o),b},render:(l,o)=>{l&&!l.children.length?(l.innerHTML="",l.appendChild(o)):E(o,l),d.forEach(f=>{f()}),d=[]}}})();class re{constructor(e,t){A(this,D,void 0);A(this,W,void 0);T(this,"update");T(this,"emitEvent");x(this,W,e),x(this,D,t)}get __metadata__(){return{name:"RENDERER"}}get shadowRoot(){return i(this,D)}get hostElement(){return i(this,W)}}D=new WeakMap,W=new WeakMap;const pe={selector:"",root:!1,styles:"",deps:[],standalone:!1},se=(r,e)=>{const t=document.createElement("style");return t.innerHTML=r,e&&e.appendChild(t),t},ge=(r,e)=>{var t,s,c,n,le,m,ue,R,X,U;if(r={...pe,...r},r.styles=r.styles.toString(),r.root&&!M.isRootNodeSet)M.isRootNodeSet=!0,r.styles&&(M.globalStyles.replace(r.styles),M.globalStyleTag=se(r.styles,document.head));else if(r.root&&M.isRootNodeSet)throw Error("Cannot register duplicate root component in "+r.selector+" component");window.customElements.define(r.selector,(U=class extends HTMLElement{constructor(){super();A(this,n);A(this,m);A(this,R);A(this,t,void 0);A(this,s,void 0);A(this,c,void 0);T(this,"renderCount",0);x(this,s,this.attachShadow({mode:"open"})),J||(i(this,s).adoptedStyleSheets=M.getComputedCss(r.styles,r.standalone)),I(this,n,le).call(this),this.getInstance=this.getInstance.bind(this),this.update=this.update.bind(this)}static get observedAttributes(){return e.observedAttributes||[]}update(){const S=i(this,t).render();typeof S=="string"?i(this,s).innerHTML=de(S):te(i(this,s),S),J&&(r.styles&&i(this,s).insertBefore(i(this,c),i(this,s).childNodes[0]),M.globalStyleTag&&!r.standalone&&i(this,s).insertBefore(document.importNode(M.globalStyleTag,!0),i(this,s).childNodes[0]))}setProps(S){var w,E;for(const[L,O]of Object.entries(S))e.observedProperties.find(l=>l===L)&&(i(this,t)[L]=O);(E=(w=i(this,t)).onPropertiesChanged)==null||E.call(w)}getInstance(){return i(this,t)}connectedCallback(){var S,w,E,L;I(this,m,ue).call(this),(w=(S=i(this,t)).beforeMount)==null||w.call(S),this.update(),(L=(E=i(this,t)).mount)==null||L.call(E),I(this,R,X).call(this,"bindprops",{setProps:O=>{this.setProps(O)}},!1)}attributeChangedCallback(S,w,E){var L,O;(O=(L=i(this,t)).onAttributesChanged)==null||O.call(L,S,w,E)}disconnectedCallback(){var S,w;this.renderCount=1,(w=(S=i(this,t)).unmount)==null||w.call(S)}},t=new WeakMap,s=new WeakMap,c=new WeakMap,n=new WeakSet,le=function(){const S=new re(this,i(this,s));S.update=()=>{this.update()},S.emitEvent=(w,E)=>{I(this,R,X).call(this,w,E)},x(this,t,ee(me(this,e),r.deps,S))},m=new WeakSet,ue=function(){J&&r.styles&&x(this,c,se(r.styles))},R=new WeakSet,X=function(S,w){const E=new CustomEvent(S,{detail:w});this.dispatchEvent(E)},U))},be={deps:[]},ne=r=>e=>{if(r.selector.indexOf("-")<=0)throw new Error("You need at least 1 dash in the custom element name!");window.customElements.get(r.selector)||ge(r,e)},Y=(r={})=>e=>{if(r={...be,...r},e.prototype.__metadata__={name:"SERVICE"},r.deps.some(s=>s.__metadata__.name==="RENDERER"))throw Error("Renderer cannot be a dependency for a service. It should be used with component");const t=ee(e,r.deps);p.register(e,t)},ye=r=>{let e;switch(r.nodeName&&r.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(r.type)?e=r.checked?r.value!==null&&r.value!=="on"?r.value:!0:!1:e=r.value;break}case"select":{const t=r.type==="select-one",c=[...Array.from(r.options)].filter(n=>n.selected).map(n=>n.value??(n.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" "));e=t?c[0]:c;break}default:{e=r.value;break}}return e};class Se{constructor(e,t){A(this,z);A(this,$,void 0);A(this,C,void 0);A(this,N,new Map);x(this,$,e),x(this,C,t)}get errors(){return i(this,N)}get valid(){return I(this,z,he).call(this),!i(this,N).size}get value(){const e={};for(const[t,s]of Object.entries(i(this,C)))e[t]=s.value;return e}get(e){return i(this,C)[e]}reset(e={}){for(const t in i(this,C))i(this,C)[t].value=e[t]||i(this,$)[t];i(this,N).clear()}}$=new WeakMap,C=new WeakMap,N=new WeakMap,z=new WeakSet,he=function(){i(this,N).clear();for(const e in i(this,C)){const t=i(this,C)[e].value,s=i(this,C)[e].validators;i(this,C)[e].errors=null;for(const c of s){const n=c(t);n!==null&&(i(this,N).has(e)?(i(this,N).set(e,{...i(this,N).get(e),...n}),i(this,C)[e].errors={...i(this,C)[e].errors,...n}):(i(this,N).set(e,n),i(this,C)[e].errors=n))}}};const _e=r=>{const e={},t={};for(const[d,m]of Object.entries(r)){const v=Array.isArray(m)?m:[m];e[d]={value:v.shift(),validators:v},t[d]=e[d].value}const s=new Se(t,e);return[s,d=>m=>{const v=ye(m.target);s.get(d).value=v},()=>{s.reset()}]},ve=r=>{let e=r;return[e,s=>{let c;_(s)?c=s(e):c=s,Object.assign(e,c)}]};class we{static required(e){return e.length?null:{required:!0}}static min(e){return t=>t.length>=e?null:{minLength:{requiredLength:e}}}static max(e){return t=>t.length<=e?null:{maxLength:{requiredLength:e}}}static pattern(e){return t=>new RegExp(e).test(t)?null:{pattern:!0}}}const Ce=r=>!!r&&typeof r.subscribe=="function",Re=r=>!!r&&typeof r.then=="function",Ee=r=>({subscribe:e=>{e(r)}}),Te=r=>({subscribe:e=>{Promise.resolve(r).then(t=>{e(t)})}});class Ae{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const oe=r=>Ce(r)?r:Re(r)?Te(Promise.resolve(r)):Ee(r),j=class{static checkParams(e,t){let s=0;const c={},n=t.paramCount;for(let d=0;d<e.length;d++){const m=t.params[d];m.indexOf(":")>=0&&(c[m.split(":")[1]]=e[d].split("?")[0],s+=1)}return s===n?c:{}}static getParamCount(e){let t=0;return e.forEach(s=>{s.indexOf(":")>=0&&(t+=1)}),t}static formatRoute(e){const t={params:{},url:"",template:"",paramCount:0,isRegistered:!1,redirectTo:"",preload:e.preload,canActivate:()=>!0};if(t.params=e.path.split("/").filter(s=>s.length>0),t.url=e.path,t.template="",t.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");t.template=e.template,t.templatePath=e.templatePath}e.canActivate&&(t.canActivate=e.canActivate),t.paramCount=j.getParamCount(t.params),j.routeList.push(t)}static preloadRoutes(){for(const e of j.routeList)e.templatePath&&e.templatePath()}static preloadSelectedRoutes(){const e=j.routeList.filter(t=>t.preload===!0);for(const t of e)t.templatePath&&t.templatePath()}};let k=j;T(k,"routeList",[]);class G{constructor(){T(this,"_currentRoute",{path:"",routeParams:new Map,queryParams:new Map,state:{}});T(this,"_template",new Ae);T(this,"_unSubscribeHashEvent");T(this,"_routeStateMap",new Map)}startHashChange(){this._unSubscribeHashEvent=Z(window,"hashchange",()=>{this._registerOnHashChange()})}stopHashChange(){this._unSubscribeHashEvent()}getTemplate(){return this._template.asObservable()}getCurrentRoute(){return this._currentRoute}navigateTo(e="",t){this._routeStateMap.clear(),e?(window.location.hash.replace(/^#/,"")===e&&this._navigateTo(e,t),this._routeStateMap.set(e,t),window.location.hash="#"+e):this._navigateTo(e,t)}_registerOnHashChange(){const e=window.location.hash.replace(/^#/,""),t=this._routeStateMap.get(e);this._navigateTo(e,t)}_routeMatcher(e,t){if(e){const s=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return t.match(s)}else return e===t}_navigateTo(e,t){const s=e.split("/").filter(d=>d.length>0),c=k.routeList.filter(d=>{if(d.params.length===s.length&&this._routeMatcher(d.url,e))return d;if(d.url===e)return d}),n=c.length>0?c[0]:null;n&&(this._currentRoute.path=e,this._currentRoute.state={...t||{}},oe(n.canActivate()).subscribe(d=>{if(!d)return;const m=k.checkParams(s,n);if(Object.keys(m).length>0||e){this._currentRoute.routeParams=new Map(Object.entries(m));const v=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];this._currentRoute.queryParams=new Map(v),n.isRegistered?this._template.next(n.template):n.templatePath&&oe(n.templatePath()).subscribe(()=>{n.isRegistered=!0,this._template.next(n.template)})}else this.navigateTo(n.redirectTo,t)}))}}Y()(G);const Ne=()=>{class r{constructor(t){T(this,"_template","");T(this,"_subscriptions")}beforeMount(){this._subscriptions=this.internalRouterSrvc.getTemplate().subscribe(t=>{this._template=t}),this.internalRouterSrvc.startHashChange()}mount(){let t=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(t)}unmount(){this._subscriptions(),this.internalRouterSrvc.stopHashChange()}render(){if(this._template){const t=[`${this._template}`];return t.raw=[`${this._template}`],B(t)}else return B``}}ne({selector:"router-outlet",deps:[G]})(r)};class ie{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,t){this.internalRouter.navigateTo(e,t)}registerRoutes(e,t=!1){if(Array.isArray(e)){for(const s of e)k.formatRoute(s);t?k.preloadRoutes():k.preloadSelectedRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}Y({deps:[G]})(ie),a.Component=ne,a.Injectable=Y,a.Renderer=re,a.Router=ie,a.Validators=we,a.fromEvent=Z,a.html=B,a.registerRouterComponent=Ne,a.render=te,a.useFormFields=_e,a.useState=ve,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
