var xe=Object.defineProperty;var ke=(l,b,S)=>b in l?xe(l,b,{enumerable:!0,configurable:!0,writable:!0,value:S}):l[b]=S;var _=(l,b,S)=>(ke(l,typeof b!="symbol"?b+"":b,S),S),re=(l,b,S)=>{if(!b.has(l))throw TypeError("Cannot "+S)};var n=(l,b,S)=>(re(l,b,"read from private field"),S?S.call(l):b.get(l)),T=(l,b,S)=>{if(b.has(l))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(l):b.set(l,S)},A=(l,b,S,z)=>(re(l,b,"write to private field"),z?z.call(l,S):b.set(l,S),S);var I=(l,b,S)=>(re(l,b,"access private method"),S);(function(l,b){typeof exports=="object"&&typeof module<"u"?b(exports):typeof define=="function"&&define.amd?define(["exports"],b):(l=typeof globalThis<"u"?globalThis:l||self,b(l.PlumeJS={}))})(this,function(l){var x,he,V,W,$,C,R,J,fe,k,O,D,B,me,Y,ge,j,K;"use strict";const b=new(he=class{constructor(){T(this,x,void 0);A(this,x,new WeakMap)}register(t,e){if(!n(this,x).get(t))n(this,x).set(t,e);else throw console.error(t),"service already exists"}getService(t){const e=n(this,x).get(t);if(e)return e;throw console.error(t),"service is not a registered service."}clear(){A(this,x,new WeakMap)}},x=new WeakMap,he),S=t=>typeof t=="function",z=t=>{const e=t.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(s=>s.trim()):[]},Q=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),ne=(t,e,s,r=!1)=>(t.addEventListener(e,s,r),()=>{t.removeEventListener(e,s,r)}),be=t=>{const e=()=>new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),s=i=>{const m=i.querySelectorAll("script");for(const w of m)w.remove()},r=(i,m)=>{if(m=m.replace(/\s+/g,"").toLowerCase(),["src","href","xlink:href"].includes(i)&&(m.includes("javascript:")||m.includes("data:"))||i.startsWith("on"))return!0},c=i=>{const m=i.attributes;for(const{name:w,value:E}of m)r(w,E)&&i.removeAttribute(w)},d=i=>{const m=i.children;for(const w of m)c(w),d(w)},g=e();return s(g),d(g),g.innerHTML},ie=(t,e,s)=>{if(e.length>0){const r=[];for(const g of e)g.__metadata__?r.push(s):r.push(b.getService(g));const c=z(t),d=new t(...r);return e.forEach((g,i)=>{d[c[i]]=r[i]}),d}else return new t},N=new class{constructor(){_(this,"globalStyles");_(this,"globalStyleTag");_(this,"style_registry");_(this,"isRootNodeSet");try{this.globalStyles=new CSSStyleSheet}catch{this.globalStyles=""}this.isRootNodeSet=!1,this.globalStyleTag=null}getComputedCss(t=""){let e=[];const s=new CSSStyleSheet;if(s.insertRule(":host { display: block; }"),e=[this.globalStyles,s],t){const r=new CSSStyleSheet;r.replace(t),e.push(r)}return e}},{html:X,render:ae}=(()=>{const t=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,s="attr",r=/^attr([^ ]+)/,c="insertNode",d=/^insertNode([^ ]+)/;let g=[];const i=u=>{const a={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let f=JSON.stringify(u);const h=o=>a[o]||o;return f=(o=>o.replace(/[&<>\(\)]/g,h))(f),JSON.parse(f)},m=(u,a)=>{const f=u.options,h=Array.isArray(a)?a:[a];let p,o,y=f.length;for(;y--;){o=f[y];const v=o.getAttribute("value")??(o.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(o.selected=h.indexOf(v)>-1)&&(p=!0)}p||(u.selectedIndex=-1)},w=u=>{const a=document.createElement("template");return a.innerHTML=u,a.content},E=(u,a)=>{const f=document.createTreeWalker(u,NodeFilter.SHOW_ELEMENT,null);let h=f.nextNode();for(;h;){if(h.hasAttributes()){const p=Array.from(h.attributes).filter(o=>r.test(o.nodeName));for(const{nodeName:o,nodeValue:y}of p){const v=r.exec(o)[1];switch(!0){case/^on+/.test(y):{const P=y.slice(2).toLowerCase();h.removeEventListener(P,a[v]),P!=="bindprops"?h.addEventListener(P,a[v]):h.addEventListener(P,M=>{M.detail.setProps(a[v]())});break}case/ref/.test(y):{const P=(M=>{const U=M;return()=>{U.isConnected&&a[v](U)}})(h);g.push(P);break}case/^data-+/.test(y):case/^aria-+/.test(y):{h.setAttribute(y,i(a[v]));break}case/class/.test(y):{a[v]?h.classList.add(...a[v].split(" ")):h.setAttribute("class","");break}case/value/.test(y):{h.nodeName.toLowerCase()==="select"?m(h,a[v]):h.value=i(a[v]);break}case/disabled/.test(y):case/checked/.test(y):{a[v]?h.setAttribute(y,a[v]):h.removeAttribute(y);break}default:h.setAttribute(y,i(a[v]))}h.removeAttribute(o)}}h=f.nextNode()}},L=(u,a)=>{const f=document.createTreeWalker(u,NodeFilter.SHOW_COMMENT,null);let h=f.nextNode(),p;for(;h;){if(p=d.exec(h.data)){const o=Array.isArray(a[p[1]])?a[p[1]]:[a[p[1]]];h.replaceWith(...o),f.currentNode=u}h=f.nextNode()}},H=(u,a)=>{if(!u||!a||u.nodeType!==1||a.nodeType!==1)return;const f=u.attributes,h=a.attributes;for(const{name:p,value:o}of f)/class/.test(p)?Array.from(u.classList).every(y=>{a.classList.contains(y)||a.classList.add(y)}):(!h[p]||h[p]!==o)&&a.setAttribute(p,o);for(const{name:p}of h)/class/.test(p)?Array.from(a.classList).every(o=>{u.classList.contains(o)||a.classList.remove(o)}):f[p]||a.removeAttribute(p)},G=u=>u.nodeType===3?"text":u.nodeType===8?"comment":u.tagName.toLowerCase(),de=u=>u.childNodes&&u.childNodes.length>0?null:u.textContent,se=(u,a)=>{const f=a?Array.from(a.childNodes):[],h=u?Array.from(u.childNodes):[];let p=f.length-h.length;if(p>0)for(;p>0;p--)f[f.length-p].parentNode.removeChild(f[f.length-p]);h.forEach(function(o,y){const v=f[y];if(H(o,v),!v){a&&a.appendChild(o);return}if(G(o)!==G(v)){v.replaceWith(o);return}const P=de(o);if(P&&P!==de(v)){v.textContent=P;return}if(v.childNodes.length>0&&o.childNodes.length<1){v.innerHTML="";return}if(v.childNodes.length<1&&o.childNodes.length>0){const M=document.createDocumentFragment();se(o,M),v.appendChild(M);return}if(o.childNodes.length>0){se(o,v);return}})};return{html:(u,...a)=>{let f="";const{length:h}=u;for(let o=1;o<h;o++){const y=a[o-1];let v=!1;if(f+=u[o-1],t.test(f)&&e.test(f)&&(f=f.replace(t,(P,M,U)=>`${s}${o-1}=${U||'"'}${M}${U?"":'"'}`),v=!0),!v)switch(!0){case Array.isArray(y):case y instanceof DocumentFragment:{f+=`<!--${c}${o-1}-->`;break}case(typeof y=="object"&&y!==null):{"html"in y&&(f+=y.html);break}default:f+=y}}f+=u[h-1];const p=w(f.trim());return E(p,a),L(p,a),p},render:(u,a)=>{u&&!u.children.length?(u.innerHTML="",u.appendChild(a)):se(a,u),g.forEach(f=>{f()}),g=[]}}})();class Z{constructor(e,s){T(this,V,void 0);T(this,W,void 0);_(this,"update");_(this,"emitEvent");A(this,W,e),A(this,V,s)}static get __metadata__(){return{name:"Renderer"}}get shadowRoot(){return n(this,V)}get hostElement(){return n(this,W)}}V=new WeakMap,W=new WeakMap;const pe={selector:"",root:!1,styles:"",deps:[],standalone:!1},oe=(t,e)=>{const s=document.createElement("style");return s.innerHTML=t,e&&e.appendChild(s),s},ye=(t,e)=>{var s,r,c,d;if(t={...pe,...t},t.styles=t.styles.toString(),t.root&&!N.isRootNodeSet)N.isRootNodeSet=!0,t.styles&&(N.globalStyles.replace(t.styles),N.globalStyleTag=oe(t.styles,document.head));else if(t.root&&N.isRootNodeSet)throw Error("Cannot register duplicate root component in "+t.selector+" component");window.customElements.define(t.selector,(d=class extends HTMLElement{constructor(){super();T(this,s,void 0);T(this,r,void 0);T(this,c,void 0);A(this,r,this.attachShadow({mode:"open"})),Q||(n(this,r).adoptedStyleSheets=N.getComputedCss(t.styles,t.standalone)),this.getInstance=this.getInstance.bind(this)}static get observedAttributes(){return e.observedAttributes||[]}emulateComponent(){Q&&t.styles&&A(this,c,oe(t.styles))}update(){const i=n(this,s).render();typeof i=="string"?n(this,r).innerHTML=be(i):ae(n(this,r),i),Q&&(t.styles&&n(this,r).insertBefore(n(this,c),n(this,r).childNodes[0]),N.globalStyleTag&&!t.standalone&&n(this,r).insertBefore(document.importNode(N.globalStyleTag,!0),n(this,r).childNodes[0]))}emitEvent(i,m){const w=new CustomEvent(i,{detail:m});this.dispatchEvent(w)}setProps(i){var m,w;for(const[E,L]of Object.entries(i))e.observedProperties.find(H=>H===E)&&(n(this,s)[E]=L);(w=(m=n(this,s)).onPropertiesChanged)==null||w.call(m),this.update()}getInstance(){return n(this,s)}connectedCallback(){var m,w,E,L;this.emulateComponent();const i=new Z(this,n(this,r));i.update=()=>{this.update()},i.emitEvent=(H,G)=>{this.emitEvent(H,G)},A(this,s,ie(e,t.deps,i)),(w=(m=n(this,s)).beforeMount)==null||w.call(m),this.update(),(L=(E=n(this,s)).mount)==null||L.call(E),this.emitEvent("bindprops",{setProps:H=>{this.setProps(H)}},!1)}attributeChangedCallback(i,m,w){var E,L;(L=(E=n(this,s)).onAttributesChanged)==null||L.call(E,i,m,w)}disconnectedCallback(){var i,m;(m=(i=n(this,s)).unmount)==null||m.call(i)}},s=new WeakMap,r=new WeakMap,c=new WeakMap,d))},ve={deps:[]},ce=t=>e=>{if(t.selector.indexOf("-")<=0)throw new Error("You need at least 1 dash in the custom element name!");window.customElements.get(t.selector)||ye(t,e)},ee=(t={})=>e=>{if(t={...ve,...t},t.deps.some(r=>{var c;return((c=r.__metadata__)==null?void 0:c.name)==="Renderer"}))throw Error("Renderer cannot be a dependency for a service. It should be used with component");const s=ie(e,t.deps);b.register(e,s)},Se=t=>{let e;switch(t.nodeName&&t.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(t.type)?e=t.checked?t.value!==null&&t.value!=="on"?t.value:!0:!1:e=t.value;break}case"select":{const s=t.type==="select-one",c=[...Array.from(t.options)].filter(d=>d.selected).map(d=>d.value??(d.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" "));e=s?c[0]:c;break}default:{e=t.value;break}}return e};class we{constructor(e,s){T(this,J);T(this,$,void 0);T(this,C,void 0);T(this,R,new Map);A(this,$,e),A(this,C,s)}get errors(){return n(this,R)}get valid(){return I(this,J,fe).call(this),!n(this,R).size}get value(){const e={};for(const[s,r]of Object.entries(n(this,C)))e[s]=r.value;return e}get(e){return n(this,C)[e]}reset(e={}){for(const s in n(this,C))n(this,C)[s].value=e[s]||n(this,$)[s];n(this,R).clear()}}$=new WeakMap,C=new WeakMap,R=new WeakMap,J=new WeakSet,fe=function(){n(this,R).clear();for(const e in n(this,C)){const s=n(this,C)[e].value,r=n(this,C)[e].validators;n(this,C)[e].errors=null;for(const c of r){const d=c(s);d!==null&&(n(this,R).has(e)?(n(this,R).set(e,{...n(this,R).get(e),...d}),n(this,C)[e].errors={...n(this,C)[e].errors,...d}):(n(this,R).set(e,d),n(this,C)[e].errors=d))}}};const Te=t=>{const e={},s={};for(const[g,i]of Object.entries(t)){const m=Array.isArray(i)?i:[i];e[g]={value:m.shift(),validators:m},s[g]=e[g].value}const r=new we(s,e);return[r,g=>i=>{const m=Se(i.target);r.get(g).value=m},()=>{r.reset()}]},Ce=t=>{let e=t;return[e,r=>{let c;S(r)?c=r(e):c=r,Object.assign(e,c)}]};class Ae{static required(e){return e.length?null:{required:!0}}static min(e){return s=>s.length>=e?null:{minLength:{requiredLength:e}}}static max(e){return s=>s.length<=e?null:{maxLength:{requiredLength:e}}}static pattern(e){return s=>new RegExp(e).test(s)?null:{pattern:!0}}}const Ee=t=>!!t&&typeof t.subscribe=="function",Re=t=>!!t&&typeof t.then=="function",Pe=t=>({subscribe:e=>{e(t)}}),Le=t=>({subscribe:e=>{Promise.resolve(t).then(s=>{e(s)})}});class _e{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const le=t=>Ee(t)?t:Re(t)?Le(Promise.resolve(t)):Pe(t),q=class{static checkParams(e,s){let r=0,c={},d=s.ParamCount;for(let i=0;i<e.length;i++){var g=s.Params[i];g.indexOf(":")>=0&&(c[g.split(":")[1]]=e[i].split("?")[0],r+=1)}return r===d?c:{}}static getParamCount(e){let s=0;return e.forEach(r=>{r.indexOf(":")>=0&&(s+=1)}),s}static formatRoute(e){let s={Params:{},Url:"",Template:"",ParamCount:0,IsRegistered:!1,redirectTo:"",canActivate:()=>!0};if(s.Params=e.path.split("/").filter(r=>r.length>0),s.Url=e.path,s.Template="",s.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");s.Template=e.template,s.TemplatePath=e.templatePath}e.canActivate&&(s.canActivate=e.canActivate),s.ParamCount=q.getParamCount(s.Params),q.routeList.push(s)}static preloadRoutes(){for(const e of q.routeList)e.TemplatePath&&e.TemplatePath()}};let F=q;_(F,"routeList",[]);class te{constructor(){T(this,B);T(this,Y);T(this,j);T(this,k,{path:"",routeParams:new Map,queryParams:new Map,state:{}});T(this,O,new _e);T(this,D,void 0)}startHashChange(){A(this,D,ne(window,"hashchange",()=>{I(this,B,me).call(this)}))}stopHashChange(){n(this,D).call(this)}getTemplate(){return n(this,O).asObservable()}getCurrentRoute(){return n(this,k)}navigateTo(e="",s){e?(window.location.hash.replace(/^#/,"")===e&&I(this,j,K).call(this,e,s),window.location.hash="#"+e):I(this,j,K).call(this,e,s)}}k=new WeakMap,O=new WeakMap,D=new WeakMap,B=new WeakSet,me=function(){const e=window.location.hash.replace(/^#/,"");I(this,j,K).call(this,e,null)},Y=new WeakSet,ge=function(e,s){if(e){let r=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return s.match(r)}else return e===s},j=new WeakSet,K=function(e,s){let r=e.split("/").filter(g=>g.length>0),c=F.routeList.filter(g=>{if(g.Params.length===r.length&&I(this,Y,ge).call(this,g.Url,e))return g;if(g.Url===e)return g}),d=c.length>0?c[0]:null;d&&(n(this,k).path=e,n(this,k).state={...s||{}},le(d.canActivate()).subscribe(g=>{if(!g)return;let i=F.checkParams(r,d);if(Object.keys(i).length>0||e){n(this,k).routeParams=new Map(Object.entries(i));const m=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];n(this,k).queryParams=new Map(m),d.IsRegistered?n(this,O).next(d.Template):d.TemplatePath&&le(d.TemplatePath()).subscribe(()=>{d.IsRegistered=!0,n(this,O).next(d.Template)})}else this.navigateTo(d.redirectTo)}))},ee()(te);const Ne=()=>{var e,s;class t{constructor(c,d){T(this,e,"");T(this,s,void 0);_(this,"update")}beforeMount(){A(this,s,this.internalRouterSrvc.getTemplate().subscribe(c=>{A(this,e,c),this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){let c=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(c)}unmount(){n(this,s).call(this),this.internalRouterSrvc.stopHashChange()}render(){if(n(this,e)){const c=[`${n(this,e)}`];return c.raw=[`${n(this,e)}`],X(c)}else return X``}}e=new WeakMap,s=new WeakMap,ce({selector:"router-outlet",deps:[te,Z]})(t)};class ue{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,s){this.internalRouter.navigateTo(e,s)}registerRoutes(e,s=!1){if(Array.isArray(e)){for(let r of e)F.formatRoute(r);s&&F.preloadRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}ee({deps:[te]})(ue),l.Component=ce,l.Injectable=ee,l.Renderer=Z,l.Router=ue,l.Validators=Ae,l.fromEvent=ne,l.html=X,l.registerRouterComponent=Ne,l.render=ae,l.useFormFields=Te,l.useState=Ce,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
