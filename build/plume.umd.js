var Pe=Object.defineProperty;var Ne=(o,g,v)=>g in o?Pe(o,g,{enumerable:!0,configurable:!0,writable:!0,value:v}):o[g]=v;var N=(o,g,v)=>(Ne(o,typeof g!="symbol"?g+"":g,v),v),Z=(o,g,v)=>{if(!g.has(o))throw TypeError("Cannot "+v)};var n=(o,g,v)=>(Z(o,g,"read from private field"),v?v.call(o):g.get(o)),w=(o,g,v)=>{if(g.has(o))throw TypeError("Cannot add the same private member more than once");g instanceof WeakSet?g.add(o):g.set(o,v)},P=(o,g,v,A)=>(Z(o,g,"write to private field"),A?A.call(o,v):g.set(o,v),v);var H=(o,g,v)=>(Z(o,g,"access private method"),v);(function(o,g){typeof exports=="object"&&typeof module!="undefined"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(o=typeof globalThis!="undefined"?globalThis:o||self,g(o.PlumeJS={}))})(this,function(o){var k,le,x,I,$,U,ue,D,he,O,B,V,C,R,z,de;"use strict";const{html:g,render:v}=(()=>{const s=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,t="attr",r=/^attr([^ ]+)/,d="insertNode",f=/^insertNode([^ ]+)/;let b=[];const h=l=>{const i={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let u=JSON.stringify(l);const c=a=>i[a]||a;return u=(a=>a.replace(/[&<>\(\)]/g,c))(u),JSON.parse(u)},S=(l,i)=>{var m;const u=l.options,c=Array.isArray(i)?i:[i];let y,a,p=u.length;for(;p--;){a=u[p];const T=(m=a.getAttribute("value"))!=null?m:(a.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(a.selected=c.indexOf(T)>-1)&&(y=!0)}y||(l.selectedIndex=-1)},E=l=>{const i=document.createElement("template");return i.innerHTML=l,i.content},_=(l,i)=>{const u=document.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,null);let c=u.nextNode();for(;c;){if(c.hasAttributes()){const y=Array.from(c.attributes).filter(a=>r.test(a.nodeName));for(const{nodeName:a,nodeValue:p}of y){const m=r.exec(a)[1];switch(!0){case/^on+/.test(p):{const T=p.slice(2).toLowerCase();c.removeEventListener(T,i[m]),T!=="bindprops"?c.addEventListener(T,i[m]):c.addEventListener(T,M=>{M.detail.setProps(i[m]())});break}case/ref/.test(p):{const T=(M=>{const q=M;return()=>{q.isConnected&&i[m](q)}})(c);b.push(T);break}case/^data-+/.test(p):{c.setAttribute(`data-${p}`,h(i[m]));break}case/^aria-+/.test(p):{c.setAttribute(`aria-${p}`,h(i[m]));break}case/class/.test(p):{i[m]?c.classList.add(...i[m].split(" ")):c.setAttribute("class","");break}case/value/.test(p):{c.nodeName.toLowerCase()==="select"?S(c,i[m]):c.value=h(i[m]);break}case/disabled/.test(p):case/checked/.test(p):{i[m]?c.setAttribute(p,i[m]):c.removeAttribute(p);break}default:c.setAttribute(p,h(i[m]))}c.removeAttribute(a)}}c=u.nextNode()}},L=(l,i)=>{const u=document.createTreeWalker(l,NodeFilter.SHOW_COMMENT,null);let c=u.nextNode(),y;for(;c;){if(y=f.exec(c.data)){const a=Array.isArray(i[y[1]])?i[y[1]]:[i[y[1]]];c.replaceWith(...a),u.currentNode=l}c=u.nextNode()}},W=(l,i)=>{if(!l||!i||l.nodeType!==1||i.nodeType!==1)return;const u=l.attributes,c=i.attributes;for(const{name:y,value:a}of u)/class/.test(y)?Array.from(l.classList).every(p=>{i.classList.contains(p)||i.classList.add(p)}):(!c[y]||c[y]!==a)&&i.setAttribute(y,a);for(const{name:y}of c)/class/.test(y)?Array.from(i.classList).every(a=>{l.classList.contains(a)||i.classList.remove(a)}):u[y]||i.removeAttribute(y)},J=l=>l.nodeType===3?"text":l.nodeType===8?"comment":l.tagName.toLowerCase(),ce=l=>l.childNodes&&l.childNodes.length>0?null:l.textContent,Y=(l,i)=>{const u=i?Array.from(i.childNodes):[],c=l?Array.from(l.childNodes):[];let y=u.length-c.length;if(y>0)for(;y>0;y--)u[u.length-y].parentNode.removeChild(u[u.length-y]);c.forEach(function(a,p){const m=u[p];if(W(a,m),!m){i&&i.appendChild(a);return}if(J(a)!==J(m)){m.replaceWith(a);return}const T=ce(a);if(T&&T!==ce(m)){m.textContent=T;return}if(m.childNodes.length>0&&a.childNodes.length<1){m.innerHTML="";return}if(m.childNodes.length<1&&a.childNodes.length>0){const M=document.createDocumentFragment();Y(a,M),m.appendChild(M);return}if(a.childNodes.length>0){Y(a,m);return}})};return{html:(l,...i)=>{let u="";const{length:c}=l;for(let a=1;a<c;a++){const p=i[a-1];let m=!1;if(u+=l[a-1],s.test(u)&&e.test(u)&&(u=u.replace(s,(T,M,q)=>`${t}${a-1}=${q||'"'}${M}${q?"":'"'}`),m=!0),!m)switch(!0){case Array.isArray(p):case p instanceof DocumentFragment:{u+=`<!--${d}${a-1}-->`;break}case(typeof p=="object"&&p!==null):{"html"in p&&(u+=p.html);break}default:u+=p}}u+=l[c-1];const y=E(u.trim());return _(y,i),L(y,i),y},render:(l,i)=>{l&&!l.children.length?(l.innerHTML="",l.appendChild(i)):Y(i,l),b.forEach(u=>{u()}),b=[]}}})(),A=new class{constructor(){N(this,"globalStyles");N(this,"globalStyleTag");N(this,"style_registry");N(this,"isRootNodeSet");try{this.globalStyles=new CSSStyleSheet}catch{this.globalStyles=""}this.isRootNodeSet=!1,this.globalStyleTag=null}getComputedCss(s=""){let e=[];const t=new CSSStyleSheet;if(t.insertRule(":host { display: block; }"),e=[this.globalStyles,t],s){const r=new CSSStyleSheet;r.replace(s),e.push(r)}return e}},ee=new(le=class{constructor(){w(this,k,void 0);P(this,k,new WeakMap)}register(s,e){if(!n(this,k).get(s))n(this,k).set(s,e);else throw console.error(s),"service already exists"}getService(s){const e=n(this,k).get(s);if(e)return e;throw console.error(s),"service is not a registered service."}clear(){P(this,k,new WeakMap)}},k=new WeakMap,le),fe=s=>typeof s=="function",me=s=>{const e=s.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(t=>t.trim()):[]},G=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),te=(s,e,t,r=!1)=>(s.addEventListener(e,t,r),()=>{s.removeEventListener(e,t,r)}),se=(s,e,t)=>{if(e.length>0){const r=[];for(const b of e)b.__metadata__?r.push(t):r.push(ee.getService(b));const d=me(s),f=new s(...r);return e.forEach((b,h)=>{f[d[h]]=r[h]}),f}else return new s};class K{constructor(){N(this,"shadowRoot");N(this,"update");N(this,"emitEvent")}static get __metadata__(){return{name:"Renderer"}}}const ge={selector:"",root:!1,styles:"",deps:[],standalone:!1},re=(s,e)=>{const t=document.createElement("style");return t.innerHTML=s,e&&e.appendChild(t),t},ne=(s,e)=>{var t,r,d,f;if(!window.customElements.get(s.selector)){if(s={...ge,...s},s.styles=s.styles.toString(),s.root&&!A.isRootNodeSet)A.isRootNodeSet=!0,s.styles&&(A.globalStyles.replace(s.styles),A.globalStyleTag=re(s.styles,document.head));else if(s.root&&A.isRootNodeSet)throw Error("Cannot register duplicate root component in "+s.selector+" component");window.customElements.define(s.selector,(f=class extends HTMLElement{constructor(){super();w(this,t,void 0);w(this,r,void 0);w(this,d,void 0);P(this,r,this.attachShadow({mode:"open"})),G||(n(this,r).adoptedStyleSheets=A.getComputedCss(s.styles,s.standalone)),this.getInstance=this.getInstance.bind(this)}static get observedAttributes(){return e.observedAttributes||[]}emulateComponent(){G&&s.styles&&P(this,d,re(s.styles))}update(){v(n(this,r),(()=>n(this,t).render())()),G&&(s.styles&&n(this,r).insertBefore(n(this,d),n(this,r).childNodes[0]),A.globalStyleTag&&!s.standalone&&n(this,r).insertBefore(document.importNode(A.globalStyleTag,!0),n(this,r).childNodes[0]))}emitEvent(h,S){const E=new CustomEvent(h,{detail:S});this.dispatchEvent(E)}setProps(h){var S,E;for(const[_,L]of Object.entries(h))n(this,t)[_]=L;(E=(S=n(this,t)).onPropsChanged)==null||E.call(S),this.update()}getInstance(){return n(this,t)}connectedCallback(){var S,E,_,L;this.emulateComponent();const h=new K;h.shadowRoot=n(this,r),h.update=()=>{this.update()},h.emitEvent=(W,J)=>{this.emitEvent(W,J)},P(this,t,se(e,s.deps,h)),(E=(S=n(this,t)).beforeMount)==null||E.call(S),this.update(),(L=(_=n(this,t)).mount)==null||L.call(_),this.emitEvent("bindprops",{setProps:W=>{this.setProps(W)}},!1)}attributeChangedCallback(h,S,E){var _,L;(L=(_=n(this,t)).onNativeAttributeChanges)==null||L.call(_,h,S,E)}disconnectedCallback(){var h,S;(S=(h=n(this,t)).unmount)==null||S.call(h)}},t=new WeakMap,r=new WeakMap,d=new WeakMap,f))}},ie={deps:[]},Q=(...s)=>{let e={...ie},t;if(s[0].hasOwnProperty("deps")?(e={...ie,...s[0]},t=s[1]):t=s[0],t){const r=se(t,e.deps);ee.register(t,r)}else throw new Error("error: Requires constructor to define service")},j=class{static checkParams(e,t){let r=0,d={},f=t.ParamCount;for(let h=0;h<e.length;h++){var b=t.Params[h];b.indexOf(":")>=0&&(d[b.split(":")[1]]=e[h].split("?")[0],r+=1)}return r===f?d:{}}static getParamCount(e){let t=0;return e.forEach(r=>{r.indexOf(":")>=0&&(t+=1)}),t}static formatRoute(e){let t={Params:{},Url:"",Template:"",ParamCount:0,IsRegistered:!1,redirectTo:"",canActivate:()=>!0};if(t.Params=e.path.split("/").filter(r=>r.length>0),t.Url=e.path,t.Template="",t.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");t.Template=e.template,t.TemplatePath=e.templatePath}e.canActivate&&(t.canActivate=e.canActivate),t.ParamCount=j.getParamCount(t.Params),j.routeList.push(t)}static preloadRoutes(){for(const e of j.routeList)e.TemplatePath&&e.TemplatePath()}};let F=j;N(F,"routeList",[]);const be=s=>!!s&&typeof s.subscribe=="function",pe=s=>!!s&&typeof s.then=="function",ye=s=>({subscribe:e=>{e(s)}}),ve=s=>({subscribe:e=>{Promise.resolve(s).then(t=>{e(t)})}});class Se{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const ae=s=>be(s)?s:pe(s)?ve(Promise.resolve(s)):ye(s);class X{constructor(){w(this,U);w(this,D);w(this,O);w(this,x,{path:"",routeParams:new Map,queryParams:new Map,state:{}});w(this,I,new Se);w(this,$,void 0)}startHashChange(){P(this,$,te(window,"hashchange",()=>{H(this,U,ue).call(this)}))}stopHashChange(){n(this,$).call(this)}getTemplate(){return n(this,I).asObservable()}getCurrentRoute(){return n(this,x)}navigateTo(e="",t){e?(window.location.hash.replace(/^#/,"")===e&&H(this,O,B).call(this,e,t),window.location.hash="#"+e):H(this,O,B).call(this,e,t)}}x=new WeakMap,I=new WeakMap,$=new WeakMap,U=new WeakSet,ue=function(){const e=window.location.hash.replace(/^#/,"");H(this,O,B).call(this,e,null)},D=new WeakSet,he=function(e,t){if(e){let r=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return t.match(r)}else return e===t},O=new WeakSet,B=function(e,t){let r=e.split("/").filter(b=>b.length>0),d=F.routeList.filter(b=>{if(b.Params.length===r.length&&H(this,D,he).call(this,b.Url,e))return b;if(b.Url===e)return b}),f=d.length>0?d[0]:null;f&&(n(this,x).path=e,n(this,x).state={...t||{}},ae(f.canActivate()).subscribe(b=>{if(!b)return;let h=F.checkParams(r,f);if(Object.keys(h).length>0||e){n(this,x).routeParams=new Map(Object.entries(h));const S=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];n(this,x).queryParams=new Map(S),f.IsRegistered?n(this,I).next(f.Template):f.TemplatePath&&ae(f.TemplatePath()).subscribe(()=>{f.IsRegistered=!0,n(this,I).next(f.Template)})}else this.navigateTo(f.redirectTo)}))},Q(X);class oe{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,t){this.internalRouter.navigateTo(e,t)}registerRoutes(e,t=!1){if(Array.isArray(e)){for(let r of e)F.formatRoute(r);t&&F.preloadRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}Q({deps:[X]},oe);const we=()=>{var e,t;class s{constructor(d,f){w(this,e,"");w(this,t,void 0);N(this,"update")}beforeMount(){P(this,t,this.internalRouterSrvc.getTemplate().subscribe(d=>{P(this,e,d),this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){let d=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(d)}unmount(){n(this,t).call(this),this.internalRouterSrvc.stopHashChange()}render(){if(n(this,e)){const d=[`${n(this,e)}`];return d.raw=[`${n(this,e)}`],g(d)}else return g``}}e=new WeakMap,t=new WeakMap,ne({selector:"router-outlet",deps:[X,K]},s)},Ce=s=>{let e=s;return[e,r=>{let d;fe(r)?d=r(e):d=r,Object.assign(e,d)}]},Te=s=>{let e;switch(s.nodeName&&s.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(s.type)?e=s.checked?s.value!==null&&s.value!=="on"?s.value:!0:!1:e=s.value;break}case"select":{const t=s.type==="select-one",d=[...Array.from(s.options)].filter(f=>f.selected).map(f=>{var b;return(b=f.value)!=null?b:(f.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")});e=t?d[0]:d;break}default:{e=s.value;break}}return e};class Ae{constructor(e,t){w(this,z);w(this,V,void 0);w(this,C,void 0);w(this,R,new Map);P(this,V,e),P(this,C,t)}get errors(){return n(this,R)}get valid(){return H(this,z,de).call(this),!n(this,R).size}get value(){const e={};for(const[t,r]of Object.entries(n(this,C)))e[t]=r.value;return e}get(e){return n(this,C)[e]}reset(e={}){for(const t in n(this,C))n(this,C)[t].value=e[t]||n(this,V)[t];n(this,R).clear()}}V=new WeakMap,C=new WeakMap,R=new WeakMap,z=new WeakSet,de=function(){n(this,R).clear();for(const e in n(this,C)){const t=n(this,C)[e].value,r=n(this,C)[e].validators;n(this,C)[e].errors=null;for(const d of r){const f=d(t);f!==null&&(n(this,R).has(e)?(n(this,R).set(e,{...n(this,R).get(e),...f}),n(this,C)[e].errors={...n(this,C)[e].errors,...f}):(n(this,R).set(e,f),n(this,C)[e].errors=f))}}};const Re=s=>{const e={},t={};for(const[b,h]of Object.entries(s)){const S=Array.isArray(h)?h:[h];e[b]={value:S.shift(),validators:S},t[b]=e[b].value}const r=new Ae(t,e);return[r,b=>h=>{const S=Te(h.target);r.get(b).value=S},()=>{r.reset()}]};class Ee{static required(e){return e.length?null:{required:!0}}static min(e){return t=>t.length>=e?null:{minLength:{requiredLength:e}}}static max(e){return t=>t.length<=e?null:{maxLength:{requiredLength:e}}}static pattern(e){return t=>new RegExp(e).test(t)?null:{pattern:!0}}}o.Component=ne,o.Renderer=K,o.Router=oe,o.Service=Q,o.Validators=Ee,o.fromNativeEvent=te,o.html=g,o.registerRouterComponent=we,o.render=v,o.useFormFields=Re,o.useState=Ce,Object.defineProperties(o,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
