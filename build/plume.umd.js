var xe=Object.defineProperty;var ke=(l,p,S)=>p in l?xe(l,p,{enumerable:!0,configurable:!0,writable:!0,value:S}):l[p]=S;var N=(l,p,S)=>(ke(l,typeof p!="symbol"?p+"":p,S),S),re=(l,p,S)=>{if(!p.has(l))throw TypeError("Cannot "+S)};var n=(l,p,S)=>(re(l,p,"read from private field"),S?S.call(l):p.get(l)),C=(l,p,S)=>{if(p.has(l))throw TypeError("Cannot add the same private member more than once");p instanceof WeakSet?p.add(l):p.set(l,S)},R=(l,p,S,U)=>(re(l,p,"write to private field"),U?U.call(l,S):p.set(l,S),S);var O=(l,p,S)=>(re(l,p,"access private method"),S);(function(l,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(l=typeof globalThis<"u"?globalThis:l||self,p(l.PlumeJS={}))})(this,function(l){var k,he,W,$,q,T,E,J,fe,M,j,D,B,me,Y,ge,V,K;"use strict";const p=new(he=class{constructor(){C(this,k,void 0);R(this,k,new WeakMap)}register(s,e){if(!n(this,k).get(s))n(this,k).set(s,e);else throw console.error(s),"service already exists"}getService(s){const e=n(this,k).get(s);if(e)return e;throw console.error(s),"service is not a registered service."}clear(){R(this,k,new WeakMap)}},k=new WeakMap,he),S=s=>typeof s=="function",U=s=>{const e=s.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(t=>t.trim()):[]},Q=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),ne=(s,e,t,r=!1)=>(s.addEventListener(e,t,r),()=>{s.removeEventListener(e,t,r)}),pe=s=>{const e=()=>new DOMParser().parseFromString(s,"text/html").body||document.createElement("body"),t=o=>{const g=o.querySelectorAll("script");for(const w of g)w.remove()},r=(o,g)=>{if(g=g.replace(/\s+/g,"").toLowerCase(),["src","href","xlink:href"].includes(o)&&(g.includes("javascript:")||g.includes("data:"))||o.startsWith("on"))return!0},c=o=>{const g=o.attributes;for(const{name:w,value:A}of g)r(w,A)&&o.removeAttribute(w)},d=o=>{const g=o.children;for(const w of g)c(w),d(w)},m=e();return t(m),d(m),m.innerHTML},ie=(s,e,t)=>{if(e.length>0){const r=[];for(const m of e)m.__metadata__?r.push(t):r.push(p.getService(m));const c=U(s),d=new s(...r);return e.forEach((m,o)=>{d[c[o]]=r[o]}),d}else return new s},_=new class{constructor(){N(this,"globalStyles");N(this,"globalStyleTag");N(this,"style_registry");N(this,"isRootNodeSet");try{this.globalStyles=new CSSStyleSheet}catch{this.globalStyles=""}this.isRootNodeSet=!1,this.globalStyleTag=null}getComputedCss(s=""){let e=[];const t=new CSSStyleSheet;if(t.insertRule(":host { display: block; }"),e=[this.globalStyles,t],s){const r=new CSSStyleSheet;r.replace(s),e.push(r)}return e}},{html:X,render:oe}=(()=>{const s=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,t="attr",r=/^attr([^ ]+)/,c="insertNode",d=/^insertNode([^ ]+)/;let m=[];const o=u=>{const i={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let f=JSON.stringify(u);const h=a=>i[a]||a;return f=(a=>a.replace(/[&<>\(\)]/g,h))(f),JSON.parse(f)},g=(u,i)=>{const f=u.options,h=Array.isArray(i)?i:[i];let b,a,y=f.length;for(;y--;){a=f[y];const v=a.getAttribute("value")??(a.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(a.selected=h.indexOf(v)>-1)&&(b=!0)}b||(u.selectedIndex=-1)},w=u=>{const i=document.createElement("template");return i.innerHTML=u,i.content},A=(u,i)=>{const f=document.createTreeWalker(u,NodeFilter.SHOW_ELEMENT,null);let h=f.nextNode();for(;h;){if(h.hasAttributes()){const b=Array.from(h.attributes).filter(a=>r.test(a.nodeName));for(const{nodeName:a,nodeValue:y}of b){const v=r.exec(a)[1];switch(!0){case/^on+/.test(y):{const P=y.slice(2).toLowerCase();h.removeEventListener(P,i[v]),P!=="bindprops"?h.addEventListener(P,i[v]):h.addEventListener(P,F=>{F.detail.setProps(i[v]())});break}case/ref/.test(y):{const P=(F=>{const z=F;return()=>{z.isConnected&&i[v](z)}})(h);m.push(P);break}case/^data-+/.test(y):case/^aria-+/.test(y):{h.setAttribute(y,o(i[v]));break}case/class/.test(y):{i[v]?h.classList.add(...i[v].split(" ")):h.setAttribute("class","");break}case/value/.test(y):{h.nodeName.toLowerCase()==="select"?g(h,i[v]):h.value=o(i[v]);break}case/disabled/.test(y):case/checked/.test(y):{i[v]?h.setAttribute(y,i[v]):h.removeAttribute(y);break}default:h.setAttribute(y,o(i[v]))}h.removeAttribute(a)}}h=f.nextNode()}},L=(u,i)=>{const f=document.createTreeWalker(u,NodeFilter.SHOW_COMMENT,null);let h=f.nextNode(),b;for(;h;){if(b=d.exec(h.data)){const a=Array.isArray(i[b[1]])?i[b[1]]:[i[b[1]]];h.replaceWith(...a),f.currentNode=u}h=f.nextNode()}},H=(u,i)=>{if(!u||!i||u.nodeType!==1||i.nodeType!==1)return;const f=u.attributes,h=i.attributes;for(const{name:b,value:a}of f)/class/.test(b)?Array.from(u.classList).every(y=>{i.classList.contains(y)||i.classList.add(y)}):(!h[b]||h[b]!==a)&&i.setAttribute(b,a);for(const{name:b}of h)/class/.test(b)?Array.from(i.classList).every(a=>{u.classList.contains(a)||i.classList.remove(a)}):f[b]||i.removeAttribute(b)},G=u=>u.nodeType===3?"text":u.nodeType===8?"comment":u.tagName.toLowerCase(),de=u=>u.childNodes&&u.childNodes.length>0?null:u.textContent,se=(u,i)=>{const f=i?Array.from(i.childNodes):[],h=u?Array.from(u.childNodes):[];let b=f.length-h.length;if(b>0)for(;b>0;b--)f[f.length-b].parentNode.removeChild(f[f.length-b]);h.forEach(function(a,y){const v=f[y];if(H(a,v),!v){i&&i.appendChild(a);return}if(G(a)!==G(v)){v.replaceWith(a);return}const P=de(a);if(P&&P!==de(v)){v.textContent=P;return}if(v.childNodes.length>0&&a.childNodes.length<1){v.innerHTML="";return}if(v.childNodes.length<1&&a.childNodes.length>0){const F=document.createDocumentFragment();se(a,F),v.appendChild(F);return}if(a.childNodes.length>0){se(a,v);return}})};return{html:(u,...i)=>{let f="";const{length:h}=u;for(let a=1;a<h;a++){const y=i[a-1];let v=!1;if(f+=u[a-1],s.test(f)&&e.test(f)&&(f=f.replace(s,(P,F,z)=>`${t}${a-1}=${z||'"'}${F}${z?"":'"'}`),v=!0),!v)switch(!0){case Array.isArray(y):case y instanceof DocumentFragment:{f+=`<!--${c}${a-1}-->`;break}case(typeof y=="object"&&y!==null):{"html"in y&&(f+=y.html);break}default:f+=y}}f+=u[h-1];const b=w(f.trim());return A(b,i),L(b,i),b},render:(u,i)=>{u&&!u.children.length?(u.innerHTML="",u.appendChild(i)):se(i,u),m.forEach(f=>{f()}),m=[]}}})();class Z{constructor(e,t){C(this,W,void 0);C(this,$,void 0);N(this,"update");N(this,"emitEvent");R(this,$,e),R(this,W,t)}static get __metadata__(){return{name:"Renderer"}}get shadowRoot(){return n(this,W)}get hostElement(){return n(this,$)}}W=new WeakMap,$=new WeakMap;const be={selector:"",root:!1,styles:"",deps:[],standalone:!1},ae=(s,e)=>{const t=document.createElement("style");return t.innerHTML=s,e&&e.appendChild(t),t},ye=(s,e)=>{var t,r,c,d;if(s={...be,...s},s.styles=s.styles.toString(),s.root&&!_.isRootNodeSet)_.isRootNodeSet=!0,s.styles&&(_.globalStyles.replace(s.styles),_.globalStyleTag=ae(s.styles,document.head));else if(s.root&&_.isRootNodeSet)throw Error("Cannot register duplicate root component in "+s.selector+" component");window.customElements.define(s.selector,(d=class extends HTMLElement{constructor(){super();C(this,t,void 0);C(this,r,void 0);C(this,c,void 0);R(this,r,this.attachShadow({mode:"open"})),Q||(n(this,r).adoptedStyleSheets=_.getComputedCss(s.styles,s.standalone)),this.getInstance=this.getInstance.bind(this)}static get observedAttributes(){return e.observedAttributes||[]}emulateComponent(){Q&&s.styles&&R(this,c,ae(s.styles))}update(){const o=n(this,t).render();typeof o=="string"?n(this,r).innerHTML=pe(o):oe(n(this,r),o),Q&&(s.styles&&n(this,r).insertBefore(n(this,c),n(this,r).childNodes[0]),_.globalStyleTag&&!s.standalone&&n(this,r).insertBefore(document.importNode(_.globalStyleTag,!0),n(this,r).childNodes[0]))}emitEvent(o,g){const w=new CustomEvent(o,{detail:g});this.dispatchEvent(w)}setProps(o){var g,w;for(const[A,L]of Object.entries(o))e.observedProperties.find(H=>H===A)&&(n(this,t)[A]=L);(w=(g=n(this,t)).onPropertiesChanged)==null||w.call(g),this.update()}getInstance(){return n(this,t)}connectedCallback(){var g,w,A,L;this.emulateComponent();const o=new Z(this,n(this,r));o.update=()=>{this.update()},o.emitEvent=(H,G)=>{this.emitEvent(H,G)},R(this,t,ie(e,s.deps,o)),(w=(g=n(this,t)).beforeMount)==null||w.call(g),this.update(),(L=(A=n(this,t)).mount)==null||L.call(A),this.emitEvent("bindprops",{setProps:H=>{this.setProps(H)}},!1)}attributeChangedCallback(o,g,w){var A,L;(L=(A=n(this,t)).onAttributesChanged)==null||L.call(A,o,g,w)}disconnectedCallback(){var o,g;(g=(o=n(this,t)).unmount)==null||g.call(o)}},t=new WeakMap,r=new WeakMap,c=new WeakMap,d))},ve={deps:[]},ce=s=>e=>{if(s.selector.indexOf("-")<=0)throw new Error("You need at least 1 dash in the custom element name!");window.customElements.get(s.selector)||ye(s,e)},ee=(s={})=>e=>{if(s={...ve,...s},s.deps.some(r=>{var c;return((c=r.__metadata__)==null?void 0:c.name)==="Renderer"}))throw Error("Renderer cannot be a dependency for a service. It should be used with component");const t=ie(e,s.deps);p.register(e,t)},Se=s=>{let e;switch(s.nodeName&&s.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(s.type)?e=s.checked?s.value!==null&&s.value!=="on"?s.value:!0:!1:e=s.value;break}case"select":{const t=s.type==="select-one",c=[...Array.from(s.options)].filter(d=>d.selected).map(d=>d.value??(d.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" "));e=t?c[0]:c;break}default:{e=s.value;break}}return e};class we{constructor(e,t){C(this,J);C(this,q,void 0);C(this,T,void 0);C(this,E,new Map);R(this,q,e),R(this,T,t)}get errors(){return n(this,E)}get valid(){return O(this,J,fe).call(this),!n(this,E).size}get value(){const e={};for(const[t,r]of Object.entries(n(this,T)))e[t]=r.value;return e}get(e){return n(this,T)[e]}reset(e={}){for(const t in n(this,T))n(this,T)[t].value=e[t]||n(this,q)[t];n(this,E).clear()}}q=new WeakMap,T=new WeakMap,E=new WeakMap,J=new WeakSet,fe=function(){n(this,E).clear();for(const e in n(this,T)){const t=n(this,T)[e].value,r=n(this,T)[e].validators;n(this,T)[e].errors=null;for(const c of r){const d=c(t);d!==null&&(n(this,E).has(e)?(n(this,E).set(e,{...n(this,E).get(e),...d}),n(this,T)[e].errors={...n(this,T)[e].errors,...d}):(n(this,E).set(e,d),n(this,T)[e].errors=d))}}};const Ce=s=>{const e={},t={};for(const[m,o]of Object.entries(s)){const g=Array.isArray(o)?o:[o];e[m]={value:g.shift(),validators:g},t[m]=e[m].value}const r=new we(t,e);return[r,m=>o=>{const g=Se(o.target);r.get(m).value=g},()=>{r.reset()}]},Te=s=>{let e=s;return[e,r=>{let c;S(r)?c=r(e):c=r,Object.assign(e,c)}]};class Re{static required(e){return e.length?null:{required:!0}}static min(e){return t=>t.length>=e?null:{minLength:{requiredLength:e}}}static max(e){return t=>t.length<=e?null:{maxLength:{requiredLength:e}}}static pattern(e){return t=>new RegExp(e).test(t)?null:{pattern:!0}}}const Ae=s=>!!s&&typeof s.subscribe=="function",Ee=s=>!!s&&typeof s.then=="function",Pe=s=>({subscribe:e=>{e(s)}}),Le=s=>({subscribe:e=>{Promise.resolve(s).then(t=>{e(t)})}});class Ne{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const le=s=>Ae(s)?s:Ee(s)?Le(Promise.resolve(s)):Pe(s),I=class{static checkParams(e,t){let r=0;const c={},d=t.paramCount;for(let m=0;m<e.length;m++){const o=t.params[m];o.indexOf(":")>=0&&(c[o.split(":")[1]]=e[m].split("?")[0],r+=1)}return r===d?c:{}}static getParamCount(e){let t=0;return e.forEach(r=>{r.indexOf(":")>=0&&(t+=1)}),t}static formatRoute(e){const t={params:{},url:"",template:"",paramCount:0,isRegistered:!1,redirectTo:"",preload:e.preload,canActivate:()=>!0};if(t.params=e.path.split("/").filter(r=>r.length>0),t.url=e.path,t.template="",t.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");t.template=e.template,t.templatePath=e.templatePath}e.canActivate&&(t.canActivate=e.canActivate),t.paramCount=I.getParamCount(t.params),I.routeList.push(t)}static preloadRoutes(){for(const e of I.routeList)e.templatePath&&e.templatePath()}static preloadSelectedRoutes(){const e=I.routeList.filter(t=>t.preload===!0);for(const t of e)t.templatePath&&t.templatePath()}};let x=I;N(x,"routeList",[]);class te{constructor(){C(this,B);C(this,Y);C(this,V);C(this,M,{path:"",routeParams:new Map,queryParams:new Map,state:{}});C(this,j,new Ne);C(this,D,void 0)}startHashChange(){R(this,D,ne(window,"hashchange",()=>{O(this,B,me).call(this)}))}stopHashChange(){n(this,D).call(this)}getTemplate(){return n(this,j).asObservable()}getCurrentRoute(){return n(this,M)}navigateTo(e="",t){e?(window.location.hash.replace(/^#/,"")===e&&O(this,V,K).call(this,e,t),window.location.hash="#"+e):O(this,V,K).call(this,e,t)}}M=new WeakMap,j=new WeakMap,D=new WeakMap,B=new WeakSet,me=function(){const e=window.location.hash.replace(/^#/,"");O(this,V,K).call(this,e,null)},Y=new WeakSet,ge=function(e,t){if(e){const r=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return t.match(r)}else return e===t},V=new WeakSet,K=function(e,t){const r=e.split("/").filter(m=>m.length>0),c=x.routeList.filter(m=>{if(m.params.length===r.length&&O(this,Y,ge).call(this,m.url,e))return m;if(m.url===e)return m}),d=c.length>0?c[0]:null;d&&(n(this,M).path=e,n(this,M).state={...t||{}},le(d.canActivate()).subscribe(m=>{if(!m)return;const o=x.checkParams(r,d);if(Object.keys(o).length>0||e){n(this,M).routeParams=new Map(Object.entries(o));const g=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];n(this,M).queryParams=new Map(g),d.isRegistered?n(this,j).next(d.template):d.templatePath&&le(d.templatePath()).subscribe(()=>{d.isRegistered=!0,n(this,j).next(d.template)})}else this.navigateTo(d.redirectTo,t)}))},ee()(te);const _e=()=>{var e,t;class s{constructor(c,d){C(this,e,"");C(this,t,void 0);N(this,"update")}beforeMount(){R(this,t,this.internalRouterSrvc.getTemplate().subscribe(c=>{R(this,e,c),this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){let c=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(c)}unmount(){n(this,t).call(this),this.internalRouterSrvc.stopHashChange()}render(){if(n(this,e)){const c=[`${n(this,e)}`];return c.raw=[`${n(this,e)}`],X(c)}else return X``}}e=new WeakMap,t=new WeakMap,ce({selector:"router-outlet",deps:[te,Z]})(s)};class ue{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,t){this.internalRouter.navigateTo(e,t)}registerRoutes(e,t=!1){if(Array.isArray(e)){for(const r of e)x.formatRoute(r);t?x.preloadRoutes():x.preloadSelectedRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}ee({deps:[te]})(ue),l.Component=ce,l.Injectable=ee,l.Renderer=Z,l.Router=ue,l.Validators=Re,l.fromEvent=ne,l.html=X,l.registerRouterComponent=_e,l.render=oe,l.useFormFields=Ce,l.useState=Te,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
