var Te=Object.defineProperty;var ie=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var z=(i,o,d)=>o in i?Te(i,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):i[o]=d,C=(i,o)=>{for(var d in o||(o={}))Ce.call(o,d)&&z(i,d,o[d]);if(ie)for(var d of ie(o))Re.call(o,d)&&z(i,d,o[d]);return i};var R=(i,o,d)=>(z(i,typeof o!="symbol"?o+"":o,d),d),J=(i,o,d)=>{if(!o.has(i))throw TypeError("Cannot "+d)};var r=(i,o,d)=>(J(i,o,"read from private field"),d?d.call(i):o.get(i)),y=(i,o,d)=>{if(o.has(i))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(i):o.set(i,d)},P=(i,o,d,O)=>(J(i,o,"write to private field"),O?O.call(i,d):o.set(i,d),d);var F=(i,o,d)=>(J(i,o,"access private method"),d);(function(i,o){typeof exports=="object"&&typeof module!="undefined"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(i=typeof globalThis!="undefined"?globalThis:i||self,o(i.PlumeJS={}))})(this,function(i){var N,se,_,x,I,$,Pe,j,Ee,M,B,w,T;"use strict";const{html:o,render:d}=(()=>{const t=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,s="attr",n=/^attr([^ ]+)/,c="insertNode",l=/^insertNode([^ ]+)/,a=S=>{const u={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let g=JSON.stringify(S);const h=b=>u[b]||b;return g=(b=>b.replace(/[&<>\(\)]/g,h))(g),JSON.parse(g)},f=(S,u)=>{var p;const g=S.options,h=Array.isArray(u)?u:[u];let v,b,m=g.length;for(;m--;){b=g[m];const k=(p=b.getAttribute("value"))!=null?p:(b.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(b.selected=h.indexOf(k)>-1)&&(v=!0)}v||(S.selectedIndex=-1)},E=S=>{const u=document.createElement("template");return u.innerHTML=S,u.content},re=(S,u)=>{const g=document.createTreeWalker(S,NodeFilter.SHOW_ELEMENT,null);let h=g.nextNode();for(;h;){if(h.hasAttributes()){const v=Array.from(h.attributes).filter(b=>n.test(b.nodeName));for(const{nodeName:b,nodeValue:m}of v){const p=n.exec(b)[1];switch(!0){case/^on+/.test(m):{const k=m.slice(2).toLowerCase();h.removeEventListener(k,u[p]),k!=="bindprops"?h.addEventListener(k,u[p]):h.addEventListener(k,D=>{D.detail.setProps(u[p]())});break}case/ref/.test(m):{u[p](h);break}case/^data-+/.test(m):{h.setAttribute(`data-${m}`,a(u[p]));break}case/^aria-+/.test(m):{h.setAttribute(`aria-${m}`,a(u[p]));break}case/class/.test(m):{u[p]?h.classList.add(...u[p].split(" ")):h.setAttribute("class","");break}case/value/.test(m):{h.nodeName.toLowerCase()==="select"?f(h,u[p]):h.value=a(u[p]);break}case/disabled/.test(m):case/checked/.test(m):{u[p]?h.setAttribute(m,u[p]):h.removeAttribute(m);break}default:h.setAttribute(m,a(u[p]))}h.removeAttribute(b)}}h=g.nextNode()}},ve=(S,u)=>{const g=document.createTreeWalker(S,NodeFilter.SHOW_COMMENT,null);let h=g.nextNode(),v;for(;h;){if(v=l.exec(h.data)){const b=Array.isArray(u[v[1]])?u[v[1]]:[u[v[1]]];h.replaceWith(...b),g.currentNode=S}h=g.nextNode()}};return{html:(S,...u)=>{let g="";const{length:h}=S;for(let b=1;b<h;b++){const m=u[b-1];let p=!1;if(g+=S[b-1],t.test(g)&&e.test(g)&&(g=g.replace(t,(k,D,ne)=>`${s}${b-1}=${ne||'"'}${D}${ne?"":'"'}`),p=!0),!p)switch(!0){case Array.isArray(m):case m instanceof DocumentFragment:{g+=`<!--${c}${b-1}-->`;break}case(typeof m=="object"&&m!==null):{"html"in m&&(g+=m.html);break}default:g+=m}}g+=S[h-1];const v=E(g.trim());return re(v,u),ve(v,u),v},render:(S,u)=>{S.innerHTML="",S.appendChild(u)}}})(),O=new(se=class{constructor(){y(this,N,void 0);P(this,N,new WeakMap)}register(t,e){if(!r(this,N).get(t))r(this,N).set(t,e);else throw console.error(t),"service already exists"}getService(t){const e=r(this,N).get(t);if(e)return e;throw console.error(t),"service is not a registered service."}clear(){P(this,N,new WeakMap)}},N=new WeakMap,se),ae=t=>typeof t=="function",oe=t=>{const e=t.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(s=>s.trim()):[]},V=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),G=(t,e,s,n=!1)=>(t.addEventListener(e,s,n),()=>{t.removeEventListener(e,s,n)}),K=(t,e,s)=>{if(e.length>0){const n=[];for(const a of e)a.__metadata__?n.push(s):n.push(O.getService(a));const c=oe(t),l=new t(...n);return e.forEach((a,f)=>{l[c[f]]=n[f]}),l}else return new t},A=new class{constructor(){R(this,"globalStyles");R(this,"globalStyleTag");R(this,"style_registry");R(this,"isRootNodeSet");this.globalStyles=new CSSStyleSheet,this.isRootNodeSet=!1}getComputedCss(t=""){let e=[];const s=new CSSStyleSheet;if(s.insertRule(":host { display: block; }"),e=[this.globalStyles,s],t){const n=new CSSStyleSheet;n.replace(t),e.push(n)}return e}};class W{constructor(){R(this,"shadowRoot");R(this,"update");R(this,"emitEvent")}static get __metadata__(){return{name:"Renderer"}}}const Q="data-compid",le={selector:"",root:!1,styles:"",useShadow:!0,deps:[]},ce=(t,e)=>(t&&(t=e+" "+t.replace("}",` } ${e} `)),t),X=(t,e)=>{const s=document.createElement("style");return s.innerHTML=t,e&&e.appendChild(s),s},Y=(t,e)=>{var s,n,c,l;if(!window.customElements.get(t.selector)){if(t=C(C({},le),t),t.styles=t.styles.toString(),t.root&&!A.isRootNodeSet)A.isRootNodeSet=!0,t.styles&&(A.globalStyles.replace(t.styles),A.globalStyleTag=X(t.styles,document.head));else if(t.root&&A.isRootNodeSet)throw Error("Cannot register duplicate root component in "+t.selector+" component");window.customElements.define(t.selector,(l=class extends HTMLElement{constructor(){super();y(this,s,void 0);y(this,n,void 0);y(this,c,void 0);P(this,n,this.attachShadow({mode:"open"})),V||(r(this,n).adoptedStyleSheets=A.getComputedCss(t.styles)),this.getInstance=this.getInstance.bind(this)}emulateComponent(){if(V&&t.styles){const a=new Date().getTime()+Math.floor(Math.random()*1e3+1),f=ce(t.styles,`[${Q}="${a.toString()}"]`);P(this,c,X(f)),this.setAttribute(Q,a.toString())}}connectedCallback(){this.emulateComponent();const a=new W;a.shadowRoot=r(this,n),a.update=()=>{this.update()},a.emitEvent=(f,E)=>{this.emitEvent(f,E)},P(this,s,K(e,t.deps,a)),r(this,s).beforeMount&&r(this,s).beforeMount(),this.update(),r(this,s).mount&&r(this,s).mount(),this.emitEvent("bindprops",{setProps:f=>{this.setProps(f)}},!1)}update(){d(r(this,n),(()=>r(this,s).render())()),V&&(t.styles&&r(this,n).insertBefore(r(this,c),r(this,n).childNodes[0]),A.globalStyleTag&&r(this,n).insertBefore(document.importNode(A.globalStyleTag,!0),r(this,n).childNodes[0]))}emitEvent(a,f){const E=new CustomEvent(a,{detail:f});this.dispatchEvent(E)}setProps(a){for(const[f,E]of Object.entries(a))r(this,s)[f]=E;r(this,s).onPropsChanged&&r(this,s).onPropsChanged(),this.update()}getInstance(){return r(this,s)}disconnectedCallback(){r(this,s).unmount&&r(this,s).unmount()}},s=new WeakMap,n=new WeakMap,c=new WeakMap,l))}},Z={deps:[]},q=(...t)=>{let e=C({},Z),s;if(t[0].hasOwnProperty("deps")?(e=C(C({},Z),t[0]),s=t[1]):s=t[0],s){const n=K(s,e.deps);O.register(s,n)}else throw new Error("error: Requires constructor to define service")},H=class{static checkParams(e,s){let n=0,c={},l=s.ParamCount;for(let f=0;f<e.length;f++){var a=s.Params[f];a.indexOf(":")>=0&&(c[a.split(":")[1]]=e[f],n+=1)}return n===l?c:{}}static getParamCount(e){let s=0;return e.forEach(n=>{n.indexOf(":")>=0&&(s+=1)}),s}static formatRoute(e){let s={Params:{},Url:"",Template:"",ParamCount:0,IsRegistered:!1,redirectTo:"",canActivate:()=>!0};if(s.Params=e.path.split("/").filter(n=>n.length>0),s.Url=e.path,s.Template="",s.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");s.Template=e.template,s.TemplatePath=e.templatePath}e.canActivate&&(s.canActivate=e.canActivate),s.ParamCount=H.getParamCount(s.Params),H.routeList.push(s)}static preloadRoutes(){for(const e of H.routeList)e.TemplatePath&&e.TemplatePath()}};let L=H;R(L,"routeList",[]);const ue=t=>!!t&&typeof t.subscribe=="function",he=t=>!!t&&typeof t.then=="function",de=t=>({subscribe:e=>{e(t)}}),fe=t=>({subscribe:e=>{Promise.resolve(t).then(s=>{e(s)})}});class me{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const ee=t=>ue(t)?t:he(t)?fe(Promise.resolve(t)):de(t);class U{constructor(){y(this,$);y(this,j);y(this,M);y(this,_,{path:"",routeParams:new Map,queryParams:new Map,state:{}});y(this,x,new me);y(this,I,void 0)}startHashChange(){P(this,I,G(window,"hashchange",()=>{F(this,$,Pe).call(this)}))}stopHashChange(){r(this,I).call(this)}getTemplate(){return r(this,x).asObservable()}getCurrentRoute(){return r(this,_)}navigateTo(e="",s){e?(window.location.hash.replace(/^#/,"")===e&&F(this,M,B).call(this,e,s),window.location.hash="#"+e):F(this,M,B).call(this,e,s)}}_=new WeakMap,x=new WeakMap,I=new WeakMap,$=new WeakSet,Pe=function(){const e=window.location.hash.replace(/^#/,"");F(this,M,B).call(this,e,null)},j=new WeakSet,Ee=function(e,s){if(e){let n=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return s.match(n)}else return e===s},M=new WeakSet,B=function(e,s){let n=e.split("/").filter(a=>a.length>0),c=L.routeList.filter(a=>{if(a.Params.length===n.length&&F(this,j,Ee).call(this,a.Url,e))return a;if(a.Url===e)return a}),l=c.length>0?c[0]:null;l&&(r(this,_).path=e,r(this,_).state=C({},s||{}),ee(l.canActivate()).subscribe(a=>{if(!a)return;let f=L.checkParams(n,l);if(Object.keys(f).length>0||e){r(this,_).routeParams=new Map(Object.entries(f));const E=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];r(this,_).queryParams=new Map(E),l.IsRegistered?r(this,x).next(l.Template):l.TemplatePath&&ee(l.TemplatePath()).subscribe(re=>{l.IsRegistered=!0,r(this,x).next(l.Template)})}else this.navigateTo(l.redirectTo)}))},q(U);class te{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,s){this.internalRouter.navigateTo(e,s)}registerRoutes(e,s=!1){if(Array.isArray(e)){for(let n of e)L.formatRoute(n);s&&L.preloadRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}q({deps:[U]},te);const ge=()=>{var e,s;class t{constructor(c,l){y(this,e,"");y(this,s,void 0);R(this,"update")}beforeMount(){P(this,s,this.internalRouterSrvc.getTemplate().subscribe(c=>{P(this,e,c),this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){let c=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(c)}unmount(){r(this,s).call(this),this.internalRouterSrvc.stopHashChange()}render(){if(r(this,e)){const c=[`${r(this,e)}`];return c.raw=[`${r(this,e)}`],o(c)}else return o``}}e=new WeakMap,s=new WeakMap,Y({selector:"router-outlet",deps:[U,W]},t)},be=t=>{let e=t;return[e,n=>{let c;ae(n)?c=n(e):c=n,Object.assign(e,c)}]},pe=t=>{let e;switch(t.nodeName&&t.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(t.type)?e=t.checked?t.value!==null&&t.value!=="on"?t.value:!0:!1:e=t.value;break}case"select":{const s=t.type==="select-one",c=[...Array.from(t.options)].filter(l=>l.selected).map(l=>{var a;return(a=l.value)!=null?a:(l.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")});e=s?c[0]:c;break}default:{e=t.value;break}}return e};class Se{constructor(e){y(this,w,void 0);y(this,T,new Map);P(this,w,e)}get errors(){return r(this,T)}get valid(){return!r(this,T).size}get value(){const e={};for(const[s,n]of Object.entries(r(this,w)))e[s]=n.value;return e}get(e){return r(this,w)[e]}checkValidity(){r(this,T).clear();for(const e in r(this,w)){const s=r(this,w)[e].value,n=r(this,w)[e].validators;r(this,w)[e].errors=null;for(const c of n){const l=c(s);l!==null&&(r(this,T).has(e)?(r(this,T).set(e,C(C({},r(this,T).get(e)),l)),r(this,w)[e].errors=C(C({},r(this,w)[e].errors),l)):(r(this,T).set(e,l),r(this,w)[e].errors=l))}}}reset(){for(const e in r(this,w))r(this,w)[e].value="";r(this,T).clear()}}w=new WeakMap,T=new WeakMap;const we=t=>{const e={};for(const[l,a]of Object.entries(t)){const f=Array.isArray(a)?a:[a];e[l]={value:f.shift(),validators:f}}const s=new Se(e);return[s,l=>a=>{const f=pe(a.target);s.get(l).value=f,s.checkValidity()},()=>{s.reset()}]};class ye{static required(e){return e.length?null:{required:!0}}static min(e){return s=>s.length>=e?null:{minLength:{requiredLength:e}}}static max(e){return s=>s.length<=e?null:{maxLength:{requiredLength:e}}}static pattern(e){return s=>new RegExp(e).test(s)?null:{pattern:!0}}}i.Component=Y,i.Renderer=W,i.Router=te,i.Service=q,i.Validators=ye,i.fromNativeEvent=G,i.html=o,i.registerRouterComponent=ge,i.render=d,i.useFormFields=we,i.useState=be,Object.defineProperty(i,"__esModule",{value:!0}),i[Symbol.toStringTag]="Module"});
