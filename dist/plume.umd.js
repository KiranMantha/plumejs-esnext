var Ce=Object.defineProperty;var ae=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var J=(i,o,d)=>o in i?Ce(i,o,{enumerable:!0,configurable:!0,writable:!0,value:d}):i[o]=d,R=(i,o)=>{for(var d in o||(o={}))Re.call(o,d)&&J(i,d,o[d]);if(ae)for(var d of ae(o))Pe.call(o,d)&&J(i,d,o[d]);return i};var E=(i,o,d)=>(J(i,typeof o!="symbol"?o+"":o,d),d),B=(i,o,d)=>{if(!o.has(i))throw TypeError("Cannot "+d)};var n=(i,o,d)=>(B(i,o,"read from private field"),d?d.call(i):o.get(i)),w=(i,o,d)=>{if(o.has(i))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(i):o.set(i,d)},P=(i,o,d,O)=>(B(i,o,"write to private field"),O?O.call(i,d):o.set(i,d),d);var F=(i,o,d)=>(B(i,o,"access private method"),d);(function(i,o){typeof exports=="object"&&typeof module!="undefined"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(i=typeof globalThis!="undefined"?globalThis:i||self,o(i.PlumeJS={}))})(this,function(i){var N,re,_,x,I,j,Ee,V,Ae,M,G,$,y,C;"use strict";const{html:o,render:d}=(()=>{const s=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,t="attr",r=/^attr([^ ]+)/,l="insertNode",c=/^insertNode([^ ]+)/,a=S=>{const u={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let g=JSON.stringify(S);const h=b=>u[b]||b;return g=(b=>b.replace(/[&<>\(\)]/g,h))(g),JSON.parse(g)},f=(S,u)=>{var p;const g=S.options,h=Array.isArray(u)?u:[u];let T,b,m=g.length;for(;m--;){b=g[m];const k=(p=b.getAttribute("value"))!=null?p:(b.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(b.selected=h.indexOf(k)>-1)&&(T=!0)}T||(S.selectedIndex=-1)},v=S=>{const u=document.createElement("template");return u.innerHTML=S,u.content},ne=(S,u)=>{const g=document.createTreeWalker(S,NodeFilter.SHOW_ELEMENT,null);let h=g.nextNode();for(;h;){if(h.hasAttributes()){const T=Array.from(h.attributes).filter(b=>r.test(b.nodeName));for(const{nodeName:b,nodeValue:m}of T){const p=r.exec(b)[1];switch(!0){case/^on+/.test(m):{const k=m.slice(2).toLowerCase();h.removeEventListener(k,u[p]),k!=="bindprops"?h.addEventListener(k,u[p]):h.addEventListener(k,z=>{z.detail.setProps(u[p]())});break}case/ref/.test(m):{u[p](h);break}case/^data-+/.test(m):{h.setAttribute(`data-${m}`,a(u[p]));break}case/^aria-+/.test(m):{h.setAttribute(`aria-${m}`,a(u[p]));break}case/class/.test(m):{u[p]?h.classList.add(...u[p].split(" ")):h.setAttribute("class","");break}case/value/.test(m):{h.nodeName.toLowerCase()==="select"?f(h,u[p]):h.value=a(u[p]);break}case/disabled/.test(m):case/checked/.test(m):{u[p]?h.setAttribute(m,u[p]):h.removeAttribute(m);break}default:h.setAttribute(m,a(u[p]))}h.removeAttribute(b)}}h=g.nextNode()}},Te=(S,u)=>{const g=document.createTreeWalker(S,NodeFilter.SHOW_COMMENT,null);let h=g.nextNode(),T;for(;h;){if(T=c.exec(h.data)){const b=Array.isArray(u[T[1]])?u[T[1]]:[u[T[1]]];h.replaceWith(...b),g.currentNode=S}h=g.nextNode()}};return{html:(S,...u)=>{let g="";const{length:h}=S;for(let b=1;b<h;b++){const m=u[b-1];let p=!1;if(g+=S[b-1],s.test(g)&&e.test(g)&&(g=g.replace(s,(k,z,ie)=>`${t}${b-1}=${ie||'"'}${z}${ie?"":'"'}`),p=!0),!p)switch(!0){case Array.isArray(m):case m instanceof DocumentFragment:{g+=`<!--${l}${b-1}-->`;break}case(typeof m=="object"&&m!==null):{"html"in m&&(g+=m.html);break}default:g+=m}}g+=S[h-1];const T=v(g.trim());return ne(T,u),Te(T,u),T},render:(S,u)=>{S.innerHTML="",S.appendChild(u)}}})(),O=new(re=class{constructor(){w(this,N,void 0);P(this,N,new WeakMap)}register(s,e){if(!n(this,N).get(s))n(this,N).set(s,e);else throw console.error(s),"service already exists"}getService(s){const e=n(this,N).get(s);if(e)return e;throw console.error(s),"service is not a registered service."}clear(){P(this,N,new WeakMap)}},N=new WeakMap,re),oe=s=>typeof s=="function",le=s=>{const e=s.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(t=>t.trim()):[]},W=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),K=(s,e,t,r=!1)=>(s.addEventListener(e,t,r),()=>{s.removeEventListener(e,t,r)}),Q=(s,e,t)=>{if(e.length>0){const r=[];for(const a of e)a.__metadata__?r.push(t):r.push(O.getService(a));const l=le(s),c=new s(...r);return e.forEach((a,f)=>{c[l[f]]=r[f]}),c}else return new s},A=new class{constructor(){E(this,"globalStyles");E(this,"globalStyleTag");E(this,"style_registry");E(this,"isRootNodeSet");this.globalStyles=new CSSStyleSheet,this.isRootNodeSet=!1}getComputedCss(s=""){let e=[];const t=new CSSStyleSheet;if(t.insertRule(":host { display: block; }"),e=[this.globalStyles,t],s){const r=new CSSStyleSheet;r.replace(s),e.push(r)}return e}};class q{constructor(){E(this,"shadowRoot");E(this,"update");E(this,"emitEvent")}static get __metadata__(){return{name:"Renderer"}}}const X="data-compid",ce={selector:"",root:!1,styles:"",useShadow:!0,deps:[]},ue=(s,e)=>(s&&(s=e+" "+s.replace("}",` } ${e} `)),s),Y=(s,e)=>{const t=document.createElement("style");return t.innerHTML=s,e&&e.appendChild(t),t},Z=(s,e)=>{var t,r,l,c;if(!window.customElements.get(s.selector)){if(s=R(R({},ce),s),s.styles=s.styles.toString(),s.root&&!A.isRootNodeSet)A.isRootNodeSet=!0,s.styles&&(A.globalStyles.replace(s.styles),A.globalStyleTag=Y(s.styles,document.head));else if(s.root&&A.isRootNodeSet)throw Error("Cannot register duplicate root component in "+s.selector+" component");window.customElements.define(s.selector,(c=class extends HTMLElement{constructor(){super();w(this,t,void 0);w(this,r,void 0);w(this,l,void 0);P(this,r,this.attachShadow({mode:"open"})),W||(n(this,r).adoptedStyleSheets=A.getComputedCss(s.styles)),this.getInstance=this.getInstance.bind(this)}emulateComponent(){if(W&&s.styles){const a=new Date().getTime()+Math.floor(Math.random()*1e3+1),f=ue(s.styles,`[${X}="${a.toString()}"]`);P(this,l,Y(f)),this.setAttribute(X,a.toString())}}connectedCallback(){this.emulateComponent();const a=new q;a.shadowRoot=n(this,r),a.update=()=>{this.update()},a.emitEvent=(f,v)=>{this.emitEvent(f,v)},P(this,t,Q(e,s.deps,a)),n(this,t).beforeMount&&n(this,t).beforeMount(),this.update(),n(this,t).mount&&n(this,t).mount(),this.emitEvent("bindprops",{setProps:f=>{this.setProps(f)}},!1)}update(){d(n(this,r),(()=>n(this,t).render())()),W&&(s.styles&&n(this,r).insertBefore(n(this,l),n(this,r).childNodes[0]),A.globalStyleTag&&n(this,r).insertBefore(document.importNode(A.globalStyleTag,!0),n(this,r).childNodes[0]))}emitEvent(a,f){const v=new CustomEvent(a,{detail:f});this.dispatchEvent(v)}setProps(a){for(const[f,v]of Object.entries(a))n(this,t)[f]=v;n(this,t).onPropsChanged&&n(this,t).onPropsChanged(),this.update()}getInstance(){return n(this,t)}disconnectedCallback(){n(this,t).unmount&&n(this,t).unmount()}},t=new WeakMap,r=new WeakMap,l=new WeakMap,c))}},ee={deps:[]},U=(...s)=>{let e=R({},ee),t;if(s[0].hasOwnProperty("deps")?(e=R(R({},ee),s[0]),t=s[1]):t=s[0],t){const r=Q(t,e.deps);O.register(t,r)}else throw new Error("error: Requires constructor to define service")},H=class{static checkParams(e,t){let r=0,l={},c=t.ParamCount;for(let f=0;f<e.length;f++){var a=t.Params[f];a.indexOf(":")>=0&&(l[a.split(":")[1]]=e[f],r+=1)}return r===c?l:{}}static getParamCount(e){let t=0;return e.forEach(r=>{r.indexOf(":")>=0&&(t+=1)}),t}static formatRoute(e){let t={Params:{},Url:"",Template:"",ParamCount:0,IsRegistered:!1,redirectTo:"",canActivate:()=>!0};if(t.Params=e.path.split("/").filter(r=>r.length>0),t.Url=e.path,t.Template="",t.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");t.Template=e.template,t.TemplatePath=e.templatePath}e.canActivate&&(t.canActivate=e.canActivate),t.ParamCount=H.getParamCount(t.Params),H.routeList.push(t)}static preloadRoutes(){for(const e of H.routeList)e.TemplatePath&&e.TemplatePath()}};let L=H;E(L,"routeList",[]);const he=s=>!!s&&typeof s.subscribe=="function",de=s=>!!s&&typeof s.then=="function",fe=s=>({subscribe:e=>{e(s)}}),me=s=>({subscribe:e=>{Promise.resolve(s).then(t=>{e(t)})}});class ge{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const te=s=>he(s)?s:de(s)?me(Promise.resolve(s)):fe(s);class D{constructor(){w(this,j);w(this,V);w(this,M);w(this,_,{path:"",routeParams:new Map,queryParams:new Map,state:{}});w(this,x,new ge);w(this,I,void 0)}startHashChange(){P(this,I,K(window,"hashchange",()=>{F(this,j,Ee).call(this)}))}stopHashChange(){n(this,I).call(this)}getTemplate(){return n(this,x).asObservable()}getCurrentRoute(){return n(this,_)}navigateTo(e="",t){e?(window.location.hash.replace(/^#/,"")===e&&F(this,M,G).call(this,e,t),window.location.hash="#"+e):F(this,M,G).call(this,e,t)}}_=new WeakMap,x=new WeakMap,I=new WeakMap,j=new WeakSet,Ee=function(){const e=window.location.hash.replace(/^#/,"");F(this,M,G).call(this,e,null)},V=new WeakSet,Ae=function(e,t){if(e){let r=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return t.match(r)}else return e===t},M=new WeakSet,G=function(e,t){let r=e.split("/").filter(a=>a.length>0),l=L.routeList.filter(a=>{if(a.Params.length===r.length&&F(this,V,Ae).call(this,a.Url,e))return a;if(a.Url===e)return a}),c=l.length>0?l[0]:null;c&&(n(this,_).path=e,n(this,_).state=R({},t||{}),te(c.canActivate()).subscribe(a=>{if(!a)return;let f=L.checkParams(r,c);if(Object.keys(f).length>0||e){n(this,_).routeParams=new Map(Object.entries(f));const v=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];n(this,_).queryParams=new Map(v),c.IsRegistered?n(this,x).next(c.Template):c.TemplatePath&&te(c.TemplatePath()).subscribe(ne=>{c.IsRegistered=!0,n(this,x).next(c.Template)})}else this.navigateTo(c.redirectTo)}))},U(D);class se{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,t){this.internalRouter.navigateTo(e,t)}registerRoutes(e,t=!1){if(Array.isArray(e)){for(let r of e)L.formatRoute(r);t&&L.preloadRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}U({deps:[D]},se);const be=()=>{var e,t;class s{constructor(l,c){w(this,e,"");w(this,t,void 0);E(this,"update")}beforeMount(){P(this,t,this.internalRouterSrvc.getTemplate().subscribe(l=>{P(this,e,l),this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){let l=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(l)}unmount(){n(this,t).call(this),this.internalRouterSrvc.stopHashChange()}render(){if(n(this,e)){const l=[`${n(this,e)}`];return l.raw=[`${n(this,e)}`],o(l)}else return o``}}e=new WeakMap,t=new WeakMap,Z({selector:"router-outlet",deps:[D,q]},s)},pe=s=>{let e=s;return[e,r=>{let l;oe(r)?l=r(e):l=r,Object.assign(e,l)}]},Se=s=>{let e;switch(s.nodeName&&s.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(s.type)?e=s.checked?s.value!==null&&s.value!=="on"?s.value:!0:!1:e=s.value;break}case"select":{const t=s.type==="select-one",l=[...Array.from(s.options)].filter(c=>c.selected).map(c=>{var a;return(a=c.value)!=null?a:(c.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")});e=t?l[0]:l;break}default:{e=s.value;break}}return e};class we{constructor(e,t){w(this,$,void 0);w(this,y,void 0);w(this,C,new Map);P(this,$,e),P(this,y,t)}get errors(){return n(this,C)}get valid(){return this.checkValidity(),!n(this,C).size}get value(){const e={};for(const[t,r]of Object.entries(n(this,y)))e[t]=r.value;return e}get(e){return n(this,y)[e]}checkValidity(){n(this,C).clear();for(const e in n(this,y)){const t=n(this,y)[e].value,r=n(this,y)[e].validators;n(this,y)[e].errors=null;for(const l of r){const c=l(t);c!==null&&(n(this,C).has(e)?(n(this,C).set(e,R(R({},n(this,C).get(e)),c)),n(this,y)[e].errors=R(R({},n(this,y)[e].errors),c)):(n(this,C).set(e,c),n(this,y)[e].errors=c))}}}reset(e={}){for(const t in n(this,y))n(this,y)[t].value=e[t]||n(this,$)[t];n(this,C).clear()}}$=new WeakMap,y=new WeakMap,C=new WeakMap;const ye=s=>{const e={},t={};for(const[a,f]of Object.entries(s)){const v=Array.isArray(f)?f:[f];e[a]={value:v.shift(),validators:v},t[a]=e[a].value}const r=new we(t,e);return[r,a=>f=>{const v=Se(f.target);r.get(a).value=v},()=>{r.reset()}]};class ve{static required(e){return e.length?null:{required:!0}}static min(e){return t=>t.length>=e?null:{minLength:{requiredLength:e}}}static max(e){return t=>t.length<=e?null:{maxLength:{requiredLength:e}}}static pattern(e){return t=>new RegExp(e).test(t)?null:{pattern:!0}}}i.Component=Z,i.Renderer=q,i.Router=se,i.Service=U,i.Validators=ve,i.fromNativeEvent=K,i.html=o,i.registerRouterComponent=be,i.render=d,i.useFormFields=ye,i.useState=pe,Object.defineProperty(i,"__esModule",{value:!0}),i[Symbol.toStringTag]="Module"});
