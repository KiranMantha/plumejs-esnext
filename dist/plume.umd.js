var Te=Object.defineProperty;var Ce=(a,h,b)=>h in a?Te(a,h,{enumerable:!0,configurable:!0,writable:!0,value:b}):a[h]=b;var P=(a,h,b)=>(Ce(a,typeof h!="symbol"?h+"":h,b),b),G=(a,h,b)=>{if(!h.has(a))throw TypeError("Cannot "+b)};var n=(a,h,b)=>(G(a,h,"read from private field"),b?b.call(a):h.get(a)),w=(a,h,b)=>{if(h.has(a))throw TypeError("Cannot add the same private member more than once");h instanceof WeakSet?h.add(a):h.set(a,b)},R=(a,h,b,H)=>(G(a,h,"write to private field"),H?H.call(a,b):h.set(a,b),b);var L=(a,h,b)=>(G(a,h,"access private method"),b);(function(a,h){typeof exports=="object"&&typeof module!="undefined"?h(exports):typeof define=="function"&&define.amd?define(["exports"],h):(a=typeof globalThis!="undefined"?globalThis:a||self,h(a.PlumeJS={}))})(this,function(a){var A,se,N,M,O,$,ne,V,ae,F,q,j,v,C,W,ie;"use strict";const{html:h,render:b}=(()=>{const s=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,t="attr",r=/^attr([^ ]+)/,i="insertNode",o=/^insertNode([^ ]+)/,c=y=>{const l={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let m=JSON.stringify(y);const u=g=>l[g]||g;return m=(g=>g.replace(/[&<>\(\)]/g,u))(m),JSON.parse(m)},d=(y,l)=>{var p;const m=y.options,u=Array.isArray(l)?l:[l];let T,g,f=m.length;for(;f--;){g=m[f];const x=(p=g.getAttribute("value"))!=null?p:(g.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(g.selected=u.indexOf(x)>-1)&&(T=!0)}T||(y.selectedIndex=-1)},S=y=>{const l=document.createElement("template");return l.innerHTML=y,l.content},k=(y,l)=>{const m=document.createTreeWalker(y,NodeFilter.SHOW_ELEMENT,null);let u=m.nextNode();for(;u;){if(u.hasAttributes()){const T=Array.from(u.attributes).filter(g=>r.test(g.nodeName));for(const{nodeName:g,nodeValue:f}of T){const p=r.exec(g)[1];switch(!0){case/^on+/.test(f):{const x=f.slice(2).toLowerCase();u.removeEventListener(x,l[p]),x!=="bindprops"?u.addEventListener(x,l[p]):u.addEventListener(x,B=>{B.detail.setProps(l[p]())});break}case/ref/.test(f):{l[p](u);break}case/^data-+/.test(f):{u.setAttribute(`data-${f}`,c(l[p]));break}case/^aria-+/.test(f):{u.setAttribute(`aria-${f}`,c(l[p]));break}case/class/.test(f):{l[p]?u.classList.add(...l[p].split(" ")):u.setAttribute("class","");break}case/value/.test(f):{u.nodeName.toLowerCase()==="select"?d(u,l[p]):u.value=c(l[p]);break}case/disabled/.test(f):case/checked/.test(f):{l[p]?u.setAttribute(f,l[p]):u.removeAttribute(f);break}default:u.setAttribute(f,c(l[p]))}u.removeAttribute(g)}}u=m.nextNode()}},ve=(y,l)=>{const m=document.createTreeWalker(y,NodeFilter.SHOW_COMMENT,null);let u=m.nextNode(),T;for(;u;){if(T=o.exec(u.data)){const g=Array.isArray(l[T[1]])?l[T[1]]:[l[T[1]]];u.replaceWith(...g),m.currentNode=y}u=m.nextNode()}};return{html:(y,...l)=>{let m="";const{length:u}=y;for(let g=1;g<u;g++){const f=l[g-1];let p=!1;if(m+=y[g-1],s.test(m)&&e.test(m)&&(m=m.replace(s,(x,B,re)=>`${t}${g-1}=${re||'"'}${B}${re?"":'"'}`),p=!0),!p)switch(!0){case Array.isArray(f):case f instanceof DocumentFragment:{m+=`<!--${i}${g-1}-->`;break}case(typeof f=="object"&&f!==null):{"html"in f&&(m+=f.html);break}default:m+=f}}m+=y[u-1];const T=S(m.trim());return k(T,l),ve(T,l),T},render:(y,l)=>{y.innerHTML="",y.appendChild(l)}}})(),H=new(se=class{constructor(){w(this,A,void 0);R(this,A,new WeakMap)}register(s,e){if(!n(this,A).get(s))n(this,A).set(s,e);else throw console.error(s),"service already exists"}getService(s){const e=n(this,A).get(s);if(e)return e;throw console.error(s),"service is not a registered service."}clear(){R(this,A,new WeakMap)}},A=new WeakMap,se),oe=s=>typeof s=="function",le=s=>{const e=s.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(t=>t.trim()):[]},U=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),K=(s,e,t,r=!1)=>(s.addEventListener(e,t,r),()=>{s.removeEventListener(e,t,r)}),Q=(s,e,t)=>{if(e.length>0){const r=[];for(const c of e)c.__metadata__?r.push(t):r.push(H.getService(c));const i=le(s),o=new s(...r);return e.forEach((c,d)=>{o[i[d]]=r[d]}),o}else return new s},E=new class{constructor(){P(this,"globalStyles");P(this,"globalStyleTag");P(this,"style_registry");P(this,"isRootNodeSet");try{this.globalStyles=new CSSStyleSheet}catch{this.globalStyles=""}this.isRootNodeSet=!1,this.globalStyleTag=null}getComputedCss(s=""){let e=[];const t=new CSSStyleSheet;if(t.insertRule(":host { display: block; }"),e=[this.globalStyles,t],s){const r=new CSSStyleSheet;r.replace(s),e.push(r)}return e}};class D{constructor(){P(this,"shadowRoot");P(this,"update");P(this,"emitEvent")}static get __metadata__(){return{name:"Renderer"}}}const ce={selector:"",root:!1,styles:"",deps:[],standalone:!1},X=(s,e)=>{const t=document.createElement("style");return t.innerHTML=s,e&&e.appendChild(t),t},Y=(s,e)=>{var t,r,i,o;if(!window.customElements.get(s.selector)){if(s={...ce,...s},s.styles=s.styles.toString(),s.root&&!E.isRootNodeSet)E.isRootNodeSet=!0,s.styles&&(E.globalStyles.replace(s.styles),E.globalStyleTag=X(s.styles,document.head));else if(s.root&&E.isRootNodeSet)throw Error("Cannot register duplicate root component in "+s.selector+" component");window.customElements.define(s.selector,(o=class extends HTMLElement{constructor(){super();w(this,t,void 0);w(this,r,void 0);w(this,i,void 0);R(this,r,this.attachShadow({mode:"open"})),U||(n(this,r).adoptedStyleSheets=E.getComputedCss(s.styles,s.standalone)),this.getInstance=this.getInstance.bind(this)}emulateComponent(){U&&s.styles&&R(this,i,X(s.styles))}connectedCallback(){this.emulateComponent();const d=new D;d.shadowRoot=n(this,r),d.update=()=>{this.update()},d.emitEvent=(S,k)=>{this.emitEvent(S,k)},R(this,t,Q(e,s.deps,d)),n(this,t).beforeMount&&n(this,t).beforeMount(),this.update(),n(this,t).mount&&n(this,t).mount(),this.emitEvent("bindprops",{setProps:S=>{this.setProps(S)}},!1)}update(){b(n(this,r),(()=>n(this,t).render())()),U&&(s.styles&&n(this,r).insertBefore(n(this,i),n(this,r).childNodes[0]),E.globalStyleTag&&!s.standalone&&n(this,r).insertBefore(document.importNode(E.globalStyleTag,!0),n(this,r).childNodes[0]))}emitEvent(d,S){const k=new CustomEvent(d,{detail:S});this.dispatchEvent(k)}setProps(d){for(const[S,k]of Object.entries(d))n(this,t)[S]=k;n(this,t).onPropsChanged&&n(this,t).onPropsChanged(),this.update()}getInstance(){return n(this,t)}disconnectedCallback(){n(this,t).unmount&&n(this,t).unmount()}},t=new WeakMap,r=new WeakMap,i=new WeakMap,o))}},Z={deps:[]},z=(...s)=>{let e={...Z},t;if(s[0].hasOwnProperty("deps")?(e={...Z,...s[0]},t=s[1]):t=s[0],t){const r=Q(t,e.deps);H.register(t,r)}else throw new Error("error: Requires constructor to define service")},I=class{static checkParams(e,t){let r=0,i={},o=t.ParamCount;for(let d=0;d<e.length;d++){var c=t.Params[d];c.indexOf(":")>=0&&(i[c.split(":")[1]]=e[d].split("?")[0],r+=1)}return r===o?i:{}}static getParamCount(e){let t=0;return e.forEach(r=>{r.indexOf(":")>=0&&(t+=1)}),t}static formatRoute(e){let t={Params:{},Url:"",Template:"",ParamCount:0,IsRegistered:!1,redirectTo:"",canActivate:()=>!0};if(t.Params=e.path.split("/").filter(r=>r.length>0),t.Url=e.path,t.Template="",t.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");t.Template=e.template,t.TemplatePath=e.templatePath}e.canActivate&&(t.canActivate=e.canActivate),t.ParamCount=I.getParamCount(t.Params),I.routeList.push(t)}static preloadRoutes(){for(const e of I.routeList)e.TemplatePath&&e.TemplatePath()}};let _=I;P(_,"routeList",[]);const ue=s=>!!s&&typeof s.subscribe=="function",he=s=>!!s&&typeof s.then=="function",de=s=>({subscribe:e=>{e(s)}}),fe=s=>({subscribe:e=>{Promise.resolve(s).then(t=>{e(t)})}});class me{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const ee=s=>ue(s)?s:he(s)?fe(Promise.resolve(s)):de(s);class J{constructor(){w(this,$);w(this,V);w(this,F);w(this,N,{path:"",routeParams:new Map,queryParams:new Map,state:{}});w(this,M,new me);w(this,O,void 0)}startHashChange(){R(this,O,K(window,"hashchange",()=>{L(this,$,ne).call(this)}))}stopHashChange(){n(this,O).call(this)}getTemplate(){return n(this,M).asObservable()}getCurrentRoute(){return n(this,N)}navigateTo(e="",t){e?(window.location.hash.replace(/^#/,"")===e&&L(this,F,q).call(this,e,t),window.location.hash="#"+e):L(this,F,q).call(this,e,t)}}N=new WeakMap,M=new WeakMap,O=new WeakMap,$=new WeakSet,ne=function(){const e=window.location.hash.replace(/^#/,"");L(this,F,q).call(this,e,null)},V=new WeakSet,ae=function(e,t){if(e){let r=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return t.match(r)}else return e===t},F=new WeakSet,q=function(e,t){let r=e.split("/").filter(c=>c.length>0),i=_.routeList.filter(c=>{if(c.Params.length===r.length&&L(this,V,ae).call(this,c.Url,e))return c;if(c.Url===e)return c}),o=i.length>0?i[0]:null;o&&(n(this,N).path=e,n(this,N).state={...t||{}},ee(o.canActivate()).subscribe(c=>{if(!c)return;let d=_.checkParams(r,o);if(Object.keys(d).length>0||e){n(this,N).routeParams=new Map(Object.entries(d));const S=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];n(this,N).queryParams=new Map(S),o.IsRegistered?n(this,M).next(o.Template):o.TemplatePath&&ee(o.TemplatePath()).subscribe(k=>{o.IsRegistered=!0,n(this,M).next(o.Template)})}else this.navigateTo(o.redirectTo)}))},z(J);class te{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,t){this.internalRouter.navigateTo(e,t)}registerRoutes(e,t=!1){if(Array.isArray(e)){for(let r of e)_.formatRoute(r);t&&_.preloadRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}z({deps:[J]},te);const ge=()=>{var e,t;class s{constructor(i,o){w(this,e,"");w(this,t,void 0);P(this,"update")}beforeMount(){R(this,t,this.internalRouterSrvc.getTemplate().subscribe(i=>{R(this,e,i),this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){let i=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(i)}unmount(){n(this,t).call(this),this.internalRouterSrvc.stopHashChange()}render(){if(n(this,e)){const i=[`${n(this,e)}`];return i.raw=[`${n(this,e)}`],h(i)}else return h``}}e=new WeakMap,t=new WeakMap,Y({selector:"router-outlet",deps:[J,D]},s)},be=s=>{let e=s;return[e,r=>{let i;oe(r)?i=r(e):i=r,Object.assign(e,i)}]},pe=s=>{let e;switch(s.nodeName&&s.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(s.type)?e=s.checked?s.value!==null&&s.value!=="on"?s.value:!0:!1:e=s.value;break}case"select":{const t=s.type==="select-one",i=[...Array.from(s.options)].filter(o=>o.selected).map(o=>{var c;return(c=o.value)!=null?c:(o.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")});e=t?i[0]:i;break}default:{e=s.value;break}}return e};class ye{constructor(e,t){w(this,W);w(this,j,void 0);w(this,v,void 0);w(this,C,new Map);R(this,j,e),R(this,v,t)}get errors(){return n(this,C)}get valid(){return L(this,W,ie).call(this),!n(this,C).size}get value(){const e={};for(const[t,r]of Object.entries(n(this,v)))e[t]=r.value;return e}get(e){return n(this,v)[e]}reset(e={}){for(const t in n(this,v))n(this,v)[t].value=e[t]||n(this,j)[t];n(this,C).clear()}}j=new WeakMap,v=new WeakMap,C=new WeakMap,W=new WeakSet,ie=function(){n(this,C).clear();for(const e in n(this,v)){const t=n(this,v)[e].value,r=n(this,v)[e].validators;n(this,v)[e].errors=null;for(const i of r){const o=i(t);o!==null&&(n(this,C).has(e)?(n(this,C).set(e,{...n(this,C).get(e),...o}),n(this,v)[e].errors={...n(this,v)[e].errors,...o}):(n(this,C).set(e,o),n(this,v)[e].errors=o))}}};const we=s=>{const e={},t={};for(const[c,d]of Object.entries(s)){const S=Array.isArray(d)?d:[d];e[c]={value:S.shift(),validators:S},t[c]=e[c].value}const r=new ye(t,e);return[r,c=>d=>{const S=pe(d.target);r.get(c).value=S},()=>{r.reset()}]};class Se{static required(e){return e.length?null:{required:!0}}static min(e){return t=>t.length>=e?null:{minLength:{requiredLength:e}}}static max(e){return t=>t.length<=e?null:{maxLength:{requiredLength:e}}}static pattern(e){return t=>new RegExp(e).test(t)?null:{pattern:!0}}}a.Component=Y,a.Renderer=D,a.Router=te,a.Service=z,a.Validators=Se,a.fromNativeEvent=K,a.html=h,a.registerRouterComponent=ge,a.render=b,a.useFormFields=we,a.useState=be,Object.defineProperties(a,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
