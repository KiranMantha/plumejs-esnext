var Se=Object.defineProperty;var te=Object.getOwnPropertySymbols;var we=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable;var D=(n,a,h)=>a in n?Se(n,a,{enumerable:!0,configurable:!0,writable:!0,value:h}):n[a]=h,A=(n,a)=>{for(var h in a||(a={}))we.call(a,h)&&D(n,h,a[h]);if(te)for(var h of te(a))ye.call(a,h)&&D(n,h,a[h]);return n};var T=(n,a,h)=>(D(n,typeof a!="symbol"?a+"":a,h),h),V=(n,a,h)=>{if(!a.has(n))throw TypeError("Cannot "+h)};var o=(n,a,h)=>(V(n,a,"read from private field"),h?h.call(n):a.get(n)),y=(n,a,h)=>{if(a.has(n))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(n):a.set(n,h)},R=(n,a,h,x)=>(V(n,a,"write to private field"),x?x.call(n,h):a.set(n,h),h);var M=(n,a,h)=>(V(n,a,"access private method"),h);(function(n,a){typeof exports=="object"&&typeof module!="undefined"?a(exports):typeof define=="function"&&define.amd?define(["exports"],a):(n=typeof globalThis!="undefined"?globalThis:n||self,a(n.PlumeJS={}))})(this,function(n){var P,Y,E,_,L,H,Te,O,Ce,k,q;"use strict";const{html:a,render:h}=(()=>{const t=/([^\s\\>"'=]+)\s*=\s*(['"]?)$/,e=/<[a-z][^>]+$/i,s="attr",r=/^attr([^ ]+)/,c="insertNode",l=/^insertNode([^ ]+)/,i=g=>{const u={"&":"&amp;","<":"&lt;",">":"&gt;","(":"%28",")":"%29"};let f=JSON.stringify(g);const d=b=>u[b]||b;return f=(b=>b.replace(/[&<>\(\)]/g,d))(f),JSON.parse(f)},p=(g,u)=>{var S;const f=g.options,d=Array.isArray(u)?u:[u];let w,b,m=f.length;for(;m--;){b=f[m];const I=(S=b.getAttribute("value"))!=null?S:(b.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ");(b.selected=d.indexOf(I)>-1)&&(w=!0)}w||(g.selectedIndex=-1)},C=g=>{const u=document.createElement("template");return u.innerHTML=g,u.content},Z=(g,u)=>{const f=document.createTreeWalker(g,NodeFilter.SHOW_ELEMENT,null);let d=f.nextNode();for(;d;){if(d.hasAttributes()){const w=Array.from(d.attributes).filter(b=>r.test(b.nodeName));for(const{nodeName:b,nodeValue:m}of w){const S=r.exec(b)[1];switch(!0){case/^on+/.test(m):{const I=m.slice(2).toLowerCase();d.addEventListener(I,u[S]);break}case/ref/.test(m):{u[S](d);break}case/^data-+/.test(m):{d.setAttribute(`data-${m}`,i(u[S]));break}case/^aria-+/.test(m):{d.setAttribute(`aria-${m}`,i(u[S]));break}case/class/.test(m):{u[S]?d.classList.add(...u[S].split(" ")):d.setAttribute("class","");break}case/value/.test(m):{d.nodeName.toLowerCase()==="select"?p(d,u[S]):d.value=i(u[S]);break}case/disabled/.test(m):case/checked/.test(m):{u[S]?d.setAttribute(m,u[S]):d.removeAttribute(m);break}default:d.setAttribute(m,i(u[S]))}d.removeAttribute(b)}}d=f.nextNode()}},pe=(g,u)=>{const f=document.createTreeWalker(g,NodeFilter.SHOW_COMMENT,null);let d=f.nextNode(),w;for(;d;){if(w=l.exec(d.data)){const b=Array.isArray(u[w[1]])?u[w[1]]:[u[w[1]]];d.replaceWith(...b),f.currentNode=g}d=f.nextNode()}};return{html:(g,...u)=>{let f="";const{length:d}=g;for(let b=1;b<d;b++){const m=u[b-1];let S=!1;if(f+=g[b-1],t.test(f)&&e.test(f)&&(f=f.replace(t,(I,ge,ee)=>`${s}${b-1}=${ee||'"'}${ge}${ee?"":'"'}`),S=!0),!S)switch(!0){case Array.isArray(m):case m instanceof DocumentFragment:{f+=`<!--${c}${b-1}-->`;break}case(typeof m=="object"&&m!==null):{"html"in m&&(f+=m.html);break}default:f+=m}}f+=g[d-1];const w=C(f.trim());return Z(w,u),pe(w,u),w},render:(g,u)=>{g.innerHTML="",g.appendChild(u)}}})(),x=new(Y=class{constructor(){y(this,P,void 0);R(this,P,new WeakMap)}register(t,e){if(!o(this,P).get(t))o(this,P).set(t,e);else throw console.error(t),"service already exists"}getService(t){const e=o(this,P).get(t);if(e)return e;throw console.error(t),"service is not a registered service."}clear(){R(this,P,new WeakMap)}},P=new WeakMap,Y),se=t=>typeof t=="function",re=t=>{const e=t.toString().split(/constructor\s*[^\(]*\(\s*([^\)]*)\)/m);return e.length===3?e[1].split(",").map(s=>s.trim()):[]},$=(()=>{try{return new CSSStyleSheet,!1}catch{return!0}})(),ne=(t,e,s,r=!1)=>(t.addEventListener(e,s,r),()=>{t.removeEventListener(e,s,r)}),J=(t,e,s)=>{if(e.length>0){const r=[];for(const i of e)i.__metadata__?r.push(s):r.push(x.getService(i));const c=re(t),l=new t(...r);return e.forEach((i,p)=>{l[c[p]]=r[p]}),l}else return new t},v=new class{constructor(){T(this,"globalStyles");T(this,"globalStyleTag");T(this,"style_registry");T(this,"isRootNodeSet");this.globalStyles=new CSSStyleSheet,this.isRootNodeSet=!1}getComputedCss(t=""){let e=[];const s=new CSSStyleSheet;if(s.insertRule(":host { display: block; }"),e=[this.globalStyles,s],t){const r=new CSSStyleSheet;r.replace(t),e.push(r)}return e}};class j{constructor(){T(this,"shadowRoot");T(this,"update");T(this,"emitEvent")}static get __metadata__(){return{name:"Renderer"}}}const z="data-compid",ie={selector:"",root:!1,styles:"",useShadow:!0,deps:[]},ae=(t,e)=>(t&&(t=e+" "+t.replace("}",` } ${e} `)),t),B=(t,e)=>{const s=document.createElement("style");return s.innerHTML=t,e&&e.appendChild(s),s},G=(t,e)=>{var s,r,c,l;if(!window.customElements.get(t.selector)){if(t=A(A({},ie),t),t.styles=t.styles.toString(),t.root&&!v.isRootNodeSet)v.isRootNodeSet=!0,t.styles&&(v.globalStyles.replace(t.styles),v.globalStyleTag=B(t.styles,document.head));else if(t.root&&v.isRootNodeSet)throw Error("Cannot register duplicate root component in "+t.selector+" component");window.customElements.define(t.selector,(l=class extends HTMLElement{constructor(){super();y(this,s,void 0);y(this,r,void 0);y(this,c,void 0);R(this,r,this.attachShadow({mode:"open"})),$||(o(this,r).adoptedStyleSheets=v.getComputedCss(t.styles)),this.update=this.update.bind(this),this.emitEvent=this.emitEvent.bind(this),this.setProps=this.setProps.bind(this),this.getInstance=this.getInstance.bind(this)}emulateComponent(){if($&&t.styles){const i=new Date().getTime()+Math.floor(Math.random()*1e3+1),p=ae(t.styles,`[${z}="${i.toString()}"]`);R(this,c,B(p)),this.setAttribute(z,i.toString())}}connectedCallback(){this.emulateComponent();const i=new j;i.shadowRoot=o(this,r),i.update=this.update,i.emitEvent=this.emitEvent,R(this,s,J(e,t.deps,i)),o(this,s).beforeMount&&o(this,s).beforeMount(),this.update(),o(this,s).mount&&o(this,s).mount()}update(){h(o(this,r),o(this,s).render.bind(o(this,s))()),$&&(t.styles&&o(this,r).insertBefore(o(this,c),o(this,r).childNodes[0]),v.globalStyleTag&&o(this,r).insertBefore(document.importNode(v.globalStyleTag,!0),o(this,r).childNodes[0]))}emitEvent(i,p){const C=new CustomEvent(i,{detail:p});this.dispatchEvent(C)}setProps(i){for(const[p,C]of Object.entries(i))o(this,s)[p]=C;o(this,s).onPropsChanged&&o(this,s).onPropsChanged(),this.update()}getInstance(){return o(this,s)}disconnectedCallback(){o(this,s).unmount&&o(this,s).unmount()}},s=new WeakMap,r=new WeakMap,c=new WeakMap,l))}},K={deps:[]},W=(...t)=>{let e=A({},K),s;if(t[0].hasOwnProperty("deps")?(e=A(A({},K),t[0]),s=t[1]):s=t[0],s){const r=J(s,e.deps);x.register(s,r)}else throw new Error("error: Requires constructor to define service")},F=class{static checkParams(e,s){let r=0,c={},l=s.ParamCount;for(let p=0;p<e.length;p++){var i=s.Params[p];i.indexOf(":")>=0&&(c[i.split(":")[1]]=e[p],r+=1)}return r===l?c:{}}static getParamCount(e){let s=0;return e.forEach(r=>{r.indexOf(":")>=0&&(s+=1)}),s}static formatRoute(e){let s={Params:{},Url:"",Template:"",ParamCount:0,IsRegistered:!1,redirectTo:"",canActivate:()=>!0};if(s.Params=e.path.split("/").filter(r=>r.length>0),s.Url=e.path,s.Template="",s.redirectTo=e.redirectTo,e.template){if(!e.templatePath)throw Error("templatePath is required in route if template is mentioned.");s.Template=e.template,s.TemplatePath=e.templatePath}e.canActivate&&(s.canActivate=e.canActivate),s.ParamCount=F.getParamCount(s.Params),F.routeList.push(s)}static preloadRoutes(){for(const e of F.routeList)e.TemplatePath&&e.TemplatePath()}};let N=F;T(N,"routeList",[]);const oe=t=>!!t&&typeof t.subscribe=="function",ce=t=>!!t&&typeof t.then=="function",le=t=>({subscribe:e=>{e(t)}}),ue=t=>({subscribe:e=>{Promise.resolve(t).then(s=>{e(s)})}});class he{asObservable(){return{subscribe:e=>this.subscribe(e)}}subscribe(e){return this.internalFn=e,this.unsubscribe}unsubscribe(){this._internalFn=null}next(e){this.internalFn(e)}}const Q=t=>oe(t)?t:ce(t)?ue(Promise.resolve(t)):le(t);class U{constructor(){y(this,H);y(this,O);y(this,k);y(this,E,{path:"",routeParams:new Map,queryParams:new Map,state:{}});y(this,_,new he);y(this,L,void 0)}startHashChange(){R(this,L,ne(window,"hashchange",()=>{M(this,H,Te).call(this)}))}stopHashChange(){o(this,L).call(this)}getTemplate(){return o(this,_).asObservable()}getCurrentRoute(){return o(this,E)}navigateTo(e="",s){e?(window.location.hash.replace(/^#/,"")===e&&M(this,k,q).call(this,e,s),window.location.hash="#"+e):M(this,k,q).call(this,e,s)}}E=new WeakMap,_=new WeakMap,L=new WeakMap,H=new WeakSet,Te=function(){const e=window.location.hash.replace(/^#/,"");M(this,k,q).call(this,e,null)},O=new WeakSet,Ce=function(e,s){if(e){let r=new RegExp(e.replace(/:[^\s/]+/g,"([\\w-]+)"));return s.match(r)}else return e===s},k=new WeakSet,q=function(e,s){let r=e.split("/").filter(i=>i.length>0),c=N.routeList.filter(i=>{if(i.Params.length===r.length&&M(this,O,Ce).call(this,i.Url,e))return i;if(i.Url===e)return i}),l=c.length>0?c[0]:null;l&&(o(this,E).path=e,o(this,E).state=A({},s||{}),Q(l.canActivate()).subscribe(i=>{if(!i)return;let p=N.checkParams(r,l);if(Object.keys(p).length>0||e){o(this,E).routeParams=new Map(Object.entries(p));const C=window.location.hash.split("?")[1]?new URLSearchParams(window.location.hash.split("?")[1]).entries():[];o(this,E).queryParams=new Map(C),l.IsRegistered?o(this,_).next(l.Template):l.TemplatePath&&Q(l.TemplatePath()).subscribe(Z=>{l.IsRegistered=!0,o(this,_).next(l.Template)})}else this.navigateTo(l.redirectTo)}))},W(U);class de{constructor(e){}getCurrentRoute(){return this.internalRouter.getCurrentRoute()}navigateTo(e,s){this.internalRouter.navigateTo(e,s)}registerRoutes(e,s=!1){if(Array.isArray(e)){for(let r of e)N.formatRoute(r);s&&N.preloadRoutes()}else throw Error("router.addRoutes: the parameter must be an array")}}W({deps:[U]},de);const me=()=>{var e,s;class t{constructor(c,l){y(this,e,"");y(this,s,void 0);T(this,"update")}beforeMount(){R(this,s,this.internalRouterSrvc.getTemplate().subscribe(c=>{R(this,e,c),this.renderer.update()})),this.internalRouterSrvc.startHashChange()}mount(){let c=window.location.hash.replace(/^#/,"");this.internalRouterSrvc.navigateTo(c)}unmount(){o(this,s).call(this),this.internalRouterSrvc.stopHashChange()}render(){if(o(this,e)){const c=[`${o(this,e)}`];return c.raw=[`${o(this,e)}`],a(c)}else return a``}}e=new WeakMap,s=new WeakMap,G({selector:"router-outlet",deps:[U,j]},t)},X=t=>{let e=t;return[e,r=>{let c;se(r)?c=r(e):c=r,Object.assign(e,c)}]},fe=t=>{let e;switch(t.nodeName&&t.nodeName.toLowerCase()){case"input":case"textarea":{["radio","checkbox"].includes(t.type)?e=t.checked?t.value!==null&&t.value!=="on"?t.value:!0:!1:e=t.value;break}case"select":{const s=t.type==="select-one",c=[...Array.from(t.options)].filter(l=>l.selected).map(l=>{var i;return(i=l.value)!=null?i:(l.textContent.match(/[^\x20\t\r\n\f]+/g)||[]).join(" ")});e=s?c[0]:c;break}default:{e=t.value;break}}return e},be=t=>{let[e,s]=X(t);return[e,l=>i=>{let p=i.target;const C=fe(p);s(()=>(e[l]=C,e))},()=>{for(const l of Object.keys(e))e[l]=""}]};n.Component=G,n.Renderer=j,n.Service=W,n.html=a,n.registerRouterComponent=me,n.render=h,n.useFormFields=be,n.useState=X,Object.defineProperty(n,"__esModule",{value:!0}),n[Symbol.toStringTag]="Module"});
